(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1430:function(e,t){},1874:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(52),i=n.n(o),c=(n(963),n(7)),l=(n(965),n(1875)),u=n(2029),s=n(865),f=n(866),h=n(106),p=n(242),m=n(13),d=n(23),g=function(){var e=Object(m.m)().pathname,t=e.endsWith("/")&&"/"!==e?e.slice(0,-1):e,n=function(){switch(t){case"/":return 0;case"/tutorial":return 1;case"/about":return 2;case"/contact":return 3;default:return 0}}();return a.a.createElement(d.a,{position:"static",style:{backgroundColor:"rgba(42, 77, 143, 1)",minHeight:"120px",position:"relative"}},a.a.createElement("div",{style:{content:'""',position:"absolute",top:"0",right:"25vw",width:"150px",height:"120px",backgroundImage:"url(".concat("/iscvam","/image.png)"),backgroundSize:"contain",backgroundRepeat:"no-repeat",opacity:.7,transform:"rotate(-10deg)",zIndex:"-1"}}),a.a.createElement("div",{style:{content:'""',position:"absolute",top:"0",right:"23vw",width:"150px",height:"120px",backgroundImage:"url(".concat("/iscvam","/image.png)"),backgroundSize:"contain",backgroundRepeat:"no-repeat",opacity:.6,transform:"rotate(30deg)",zIndex:"-1"}}),a.a.createElement("div",{style:{content:'""',position:"absolute",top:"0",left:"24.5vw",width:"120px",height:"120px",backgroundImage:"url(".concat("/iscvam","/heatmap_capture.png)"),backgroundSize:"contain",backgroundRepeat:"no-repeat",opacity:.8,zIndex:"-1"}}),a.a.createElement(d.t,{style:{justifyContent:"center",flexDirection:"column"}},a.a.createElement(d.u,{variant:"h6",style:{color:"white",textAlign:"center",marginBottom:10,marginTop:30}},"ISCVAM: Interactive Single Cell Visual Analytics for Multiomics"),a.a.createElement(d.r,{value:n,centered:!0,style:{width:"100%"}},a.a.createElement(d.l,{label:"Home",component:p.b,to:"/",style:{color:"white"}}),a.a.createElement(d.l,{label:"Tutorial",component:p.b,to:"/tutorial",style:{color:"white"}}),a.a.createElement(d.l,{label:"About",component:p.b,to:"/about",style:{color:"white"}}),a.a.createElement(d.l,{label:"Contact",component:p.b,to:"/contact",style:{color:"white"}}))))},v=n(3),y=n(94),b=n(89),E=n(27),w=n(18);function x(){x=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),c=new I(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",p="suspendedYield",m="executing",d="completed",g={};function v(){}function y(){}function b(){}var E={};u(E,i,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(_([])));O&&O!==n&&r.call(O,i)&&(E=O);var j=b.prototype=v.prototype=Object.create(E);function C(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function L(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=h;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=S(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function S(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=b,a(j,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},C(L.prototype),u(L.prototype,c,function(){return this}),t.AsyncIterator=L,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new L(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},C(j),u(j,l,"Generator"),u(j,i,function(){return this}),u(j,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function O(e){var t=e.datasets,n=e.initialDatasetIdx,a=e.nPanels,o={},i=Object(r.useRef)(o);console.log("Initial Cache: ",o);var l=Object(w.a)(Array(a)).map(function(){return{data:null}});console.log("Initial Cache: ",o);var u=Object(r.useReducer)(function(e,t){var n=t.type,r=Object(w.a)(e);switch(n){case"FETCHING":var a=r[t.panelIdx];null!==a.data&&((o=a.data.datasetIdx)in i.current&&delete i.current[o]),a.data=null;break;case"FETCHED":case"FETCH_ERROR":break;case"LOAD_PANEL":r[t.panelIdx].data=i.current[t.datasetIdx].store,i.current[t.datasetIdx].rc++;break;case"LOAD_ALL_PANELS":console.log("Action datasetIdx:",t.datasetIdx),console.log("Cache current:",i.current),i.current[t.datasetIdx]?(r.forEach(function(e){return e.data=i.current[t.datasetIdx].store}),i.current[t.datasetIdx].rc=r.length):(console.error("Invalid datasetIdx: ".concat(t.datasetIdx)),console.error("Cache current:",i.current));break;default:throw new Error}var o;return r},l),s=Object(c.a)(u,2),f=s[0],h=s[1];function p(e,t,n,r){var a={};a.covs=e.covs,a.continuousCovs=e.continuousCovs,a.discreteCovs=e.discreteCovs,a.clusterings=r,n.layersData[t.id]=a}function m(e){return d.apply(this,arguments)}function d(){return(d=Object(E.a)(x().mark(function e(n){var r,a,o,c,l,u,s,f,h;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n||0===n){e.next=2;break}return e.abrupt("return",null);case 2:if(i.current[n]){e.next=17;break}return e.prev=3,r=t[n],a=r.name,o=r.url,c=r.layers,l=r.modalities,u=r.zip,s={layers:c,modalities:l,name:a,url:o,zip:u,layersData:{}},(f=c.map(function(){var e=Object(E.a)(x().mark(function e(t){var n,r,a,i,c;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o in t?t.url:"".concat(o,"/").concat(t.id),e.next=3,fetch(n);case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,i="".concat(n,"/clusterings"),e.next=10,fetch(i);case 10:return e.next=12,e.sent.json();case 12:c=e.sent,p(a,t,s,c);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())).push(Object(E.a)(x().mark(function e(){var t;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/meta"));case 2:return t=e.sent,e.next=5,t.json();case 5:s.meta=e.sent;case 6:case"end":return e.stop()}},e)}))()),f.push(Object(E.a)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/genesets"));case 2:return e.next=4,e.sent.json();case 4:h=e.sent;case 5:case"end":return e.stop()}},e)}))()),e.next=11,Promise.all(f);case 11:i.current[n]={store:{data:s,name:a,genesets:h,dataAPI:o,datasetIdx:n},rc:0},e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(3),e.abrupt("return",null);case 17:case"end":return e.stop()}},e,null,[[3,14]])}))).apply(this,arguments)}function g(){return(g=Object(E.a)(x().mark(function e(t,n){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h({type:"FETCHING",panelIdx:n}),e.next=3,m(t);case 3:h({type:"LOAD_PANEL",panelIdx:n,datasetIdx:t});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(r.useEffect)(function(){(function(){var e=Object(E.a)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(n);case 2:h({type:"LOAD_ALL_PANELS",datasetIdx:n});case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[t,n,a]),[f,function(e,t){return g.apply(this,arguments)}]}var j=n(2038),C=n(2042),L=n(2037),k=n(371),S=n.n(k),P=n(2033);var N=function(e){var t=e.data,n=e.clustering,o=e.heatmapAssayInEffect,i=e.usingFullMatrix,l=e.sNHControls,u=e.layer,s=o,f=Object(r.useState)(i?"allAvgsContrast":"avgsContrast"),h=Object(c.a)(f,2),p=h[0],m=h[1],d=Object(r.useState)(1e3),g=Object(c.a)(d,2),v=g[0],y=g[1],b=Object(r.useState)(1e3),E=Object(c.a)(b,2),w=E[0],x=E[1],O=Object(r.useState)(null),k=Object(c.a)(O,2),N=k[0],I=k[1],_=Object(r.useState)(""),A=Object(c.a)(_,2),M=A[0],T=A[1],D="".concat(u," - ").concat(n," - ").concat(s," -").concat(p.includes("Contrast")?"Contrast":"LogNorm"),z=Object(r.useMemo)(function(){if(t&&p&&(null===s&&Object.keys(t).includes("markers")||null!==s&&Object.keys(t).includes(s)))return function(){var e=null==s?t[p]:t[s][p],n=null!==N?N:null!==s?t[s].heatmapMarkers:t.heatmapMarkers;n=n.map(function(e){return e.toLowerCase()});var r=null!==s?t[s].clusterNames:t.clusterNames,a=new Set(n),o=Object.fromEntries(n.map(function(e,t){return[e,t]})),i=e.find(function(e){return Array.isArray(e)}),c=new Set,l=i.reduce(function(e,t,n){return!c.has(t)&&a.has(t.toLowerCase())&&(e.push({item:t,index:n}),c.add(t)),e},[]).sort(function(e,t){return o[e.item.toLowerCase()]-o[t.item.toLowerCase()]}),u=l.map(function(e){return e.item}),f=e.slice(1).map(function(e,t){return l.map(function(t){return e[t.index]})}),h=r,m=u,d=f.reduce(function(e,t){return t.map(function(n,r){return(e[r]||[]).concat(t[r])})},[]),g=d.length<30?d.length<3?100*d.length+300:50*d.length+300:17*d.length,v=300+(h.length<20?h.length<3?100*h.length:36*h.length:20*h.length);return y(g),x(v),{x:h,y:m,z:d}}()},[p,s,N]);return a.a.createElement(a.a.Fragment,null,t&&z&&a.a.createElement(L.a,{style:{width:"100%"}},"none"!==l&&a.a.createElement(a.a.Fragment,null,a.a.createElement(j.a,{style:{display:"block"},color:"primary",onChange:function(e,t){var n;(n=t)&&n!==p&&m(n)},value:p,exclusive:!0},a.a.createElement(C.a,{"data-test-id":"avgsContrast",key:"avgsContrast-heatmap",value:i?"allAvgsContrast":"avgsContrast"},"CONTRAST"),a.a.createElement(C.a,{"data-test-id":"avgsLogNorm",key:"toggleavgsLogNorm-heatmap",value:i?"allAvgsLogNorm":"avgsLogNorm"},"LOGNORM")),a.a.createElement(L.a,null,a.a.createElement(P.a,{sx:{margin:"20px",width:"400px"},placeholder:"Enter gene labels...",multiline:!0,minRows:4,maxRows:10,onChange:function(e){T(e.target.value)},value:M}),a.a.createElement("br",null),a.a.createElement(j.a,{style:{display:"block"},color:"primary"},a.a.createElement(C.a,{"data-test-id":"selectGenesButton",onClick:function(){I(M.split("\n"))},value:"A"},"SELECT GENES"),a.a.createElement(C.a,{"data-test-id":"resetGenesButton",onClick:function(){I(null),T("")},value:"B"},"RESET")))),a.a.createElement(L.a,{sx:{margin:"10px"}},D),a.a.createElement(L.a,{sx:{minHeight:"1000px",width:"100%"}},a.a.createElement(S.a,{data:[{x:z.x,y:z.y,z:z.z,type:"heatmap",colorscale:"Viridis"}],config:{displaylogo:!1,modeBarButtonsToRemove:["sendDataToCloud","hoverCompareCartesian","zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","toggleSpikelines"]},layout:{height:v,width:w,margin:"auto",xaxis:{side:"top",tickangle:35,showticklabels:!0,automargin:!0},yaxis:{autotick:!0,autorange:"reversed",automargin:!0,autoshift:!0}}}))))},I=n(2019),_=n(856),A=n(2022),M=n(2034);function T(e){var t=e.clusteringData,n=e.selectedHeatmapAssay,o=null===n?t:t[n],i=o.heatmapMarkers,l=o.markers,u=Object(r.useState)(null),s=Object(c.a)(u,2),f=s[0],h=s[1],p=Object(r.useState)(null),m=Object(c.a)(p,2),d=m[0],g=m[1];return Object(r.useEffect)(function(){var e=Object.keys(l).filter(function(e){return"gene"!==e}),t=e.map(function(e){return{field:e,headerName:e.toUpperCase(),type:"CLUSTER"!==e.toUpperCase()?"number":"string",width:"CLUSTER"!==e.toUpperCase()?70:120}});t.unshift({field:"gene",headerName:"GENE",width:250});var n=t.map(function(e){return l[e.field]});n.forEach(function(e){return delete e.name});var r=n.reduce(function(e,t){return Object.values(t).map(function(t,n){return(e[n]||[]).concat(t)})},[]).map(function(t,n){var r={id:n,gene:t[0]};return e.forEach(function(e,n){r[e]=t[n+1]}),r});g(r),h({rows:r,columns:t})},[n]),a.a.createElement(a.a.Fragment,null,null!==f&&null!==i&&a.a.createElement(A.a,Object.assign({sx:{width:"100%"},slots:{toolbar:function(){return a.a.createElement(I.a,null,a.a.createElement(_.c,{printOptions:{disableToolbarButton:!0}}),a.a.createElement(M.a,{onClick:function(){h({columns:f.columns,rows:d})}},"All Markers"),a.a.createElement(M.a,{onClick:function(){if(i){var e=function(e){var t=Object.create(null);return e.reduce(function(e,n){return n.gene in t?n.diff>e[t[n.gene]].diff&&(e[t[n.gene]]=n):t[n.gene]=e.push(n)-1,e},[])}(f.rows.filter(function(e){return i.includes(e.gene)}));e.sort(function(e,t){return i.indexOf(e.gene.toLowerCase())-i.indexOf(t.gene.toLowerCase())}),h({columns:f.columns,rows:e})}}},"Heatmap Markers"))}}},f,{pagination:{paginationModel:{pageSize:25}}})))}var D=n(353),z=n(2051),G=n(867),R=n(41),F=n.n(R),B=n(861),H=n.n(B),W=n(605);function V(e){return a.a.createElement(d.u,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)}function U(e){var t=e.inputRef,n=Object(G.a)(e,["inputRef"]);return a.a.createElement("div",Object.assign({ref:t},n))}function Y(e){return a.a.createElement(d.s,Object.assign({fullWidth:!0,InputProps:{inputComponent:U,inputProps:Object(y.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))}function q(e){return a.a.createElement(d.h,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)}function J(e){return a.a.createElement(d.u,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)}function K(e){return a.a.createElement(d.u,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)}function Z(e){return a.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}function $(e){return a.a.createElement(d.c,{tabIndex:-1,label:e.children,className:F()(e.selectProps.classes.chip,Object(v.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:a.a.createElement(H.a,e.removeProps)})}function X(e){return a.a.createElement(d.j,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)}var Q={Control:Y,Menu:X,MultiValue:$,NoOptionsMessage:V,Option:q,Placeholder:J,SingleValue:K,ValueContainer:Z},ee={Control:Y,Menu:X,MultiValue:$,NoOptionsMessage:V,Option:q,Placeholder:J,SingleValue:K,ValueContainer:Z,DropdownIndicator:function(){return null},IndicatorSeparator:function(){return null}};function te(e){return a.a.createElement(d.i,null,a.a.createElement(W.b,Object.assign({},e,{textFieldProps:{InputLabelProps:{shrink:!1}},components:Q})))}var ne=a.a.forwardRef(function(e,t){var n=0;return a.a.createElement(d.i,null,a.a.createElement(W.a,Object.assign({ref:t},e,{filterOption:function(e,t){return e.label.toLowerCase().indexOf(t.toLowerCase())>=0&&n++<50},onInputChange:function(){n=0},textFieldProps:{InputLabelProps:{shrink:!1}},components:ee})))});function re(){re=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",p="suspendedYield",m="executing",d="completed",g={};function v(){}function y(){}function b(){}var E={};u(E,i,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(I([])));x&&x!==n&&r.call(x,i)&&(E=x);var O=b.prototype=v.prototype=Object.create(E);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=h;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function ae(e){var t=e.classes,n=e.brushing,o=e.genesets,i=e.loadRemoteData,l=e.sNHControls,u=e.covs,s=e.discreteCovs,f=e.continuousCovs,h=e.features,p=Object(r.useState)([]),m=Object(c.a)(p,2),g=m[0],v=m[1],y=Object(r.useRef)(null),b=Object(r.useMemo)(function(){return s.map(function(e){return{label:e,options:Object(w.a)(new Set(u[e])).map(function(t){return{value:{group:e,term:t},label:t}})}})},[u,s]),x=Object(r.useMemo)(function(){var e=[{label:"discrete covs",options:s.map(function(e){return{value:e,label:e,group:"discrete covs"}})},{label:"continuous covs",options:f.map(function(e){return{value:e,label:e,group:"continuous covs"}})}];return h&&Object.entries(h).slice().reverse().forEach(function(t){var n=Object(c.a)(t,2),r=n[0],a=n[1];return e.push({label:r,options:a.map(function(e){return{value:e,label:e,group:r}})})}),e.push({label:"geneset",options:o.map(function(e){return{value:e,label:e,group:"geneset"}})}),e},[s,f,h,o]);function O(){return(O=Object(E.a)(re().mark(function e(t){var r,a;return re().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t?t.value:null)||r in u){e.next=5;break}return a=t.group,e.next=5,i(a,r);case 5:n.setColorBy(r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}return"none"===l?null:a.a.createElement("div",null,a.a.createElement(d.d,{className:t.searchControl,variant:"outlined"},a.a.createElement(te,{classes:t,options:b,value:g,onChange:function(e){v(e),n.setFilter(e)},placeholder:"Select ",isMulti:!0})),a.a.createElement(d.d,{className:t.paintControl,variant:"outlined"},a.a.createElement(ne,{classes:t,options:x,ref:y,formatCreateLabel:function(e){return"Look up feature: ".concat(e)},value:n.colorBy?{value:n.colorBy,label:n.colorBy}:null,onChange:function(e){return O.apply(this,arguments)},placeholder:"Paint ",isClearable:!0})))}function oe(){oe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",p="suspendedYield",m="executing",d="completed",g={};function v(){}function y(){}function b(){}var E={};u(E,i,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(I([])));x&&x!==n&&r.call(x,i)&&(E=x);var O=b.prototype=v.prototype=Object.create(E);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=h;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}var ie=function(e){var t=e.dataAPI,n=e.covs,a=Object(r.useState)(null),o=Object(c.a)(a,2),i=o[0],l=o[1];return[i,function(){var e=Object(E.a)(oe().mark(function e(r,a){var o,i,c,u,s;return oe().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=a.replace(/\u2013|\u2014|\u2212/g,"-"),e.next=3,fetch("".concat(t,"/").concat(r,"/").concat(a));case 3:return o=e.sent,e.next=6,o.json();case 6:if(i=e.sent,0!==Object.keys(i).length){e.next=10;break}return l(null),e.abrupt("return",null);case 10:return c="geneset"===r?"geneset":Object.keys(i)[0],u="geneset"===r?i:i[c],s={data:n.id.map(function(e){return e in u?u[e]:0}),category:c},l(s),e.abrupt("return",s);case 15:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()]},ce=n(141),le=n(2049),ue=n(2054),se=n(2055),fe=n(2056),he=n(2057),pe=n(2058),me=n(2052),de=n(2059),ge=n(2027);function ve(e){var t=e.count,n=e.page,r=e.rowsPerPage,o=e.onPageChange,i="rtl"===Object(ce.a)().direction,c=function(e){return function(t){return o(t,e)}};return a.a.createElement(L.a,{sx:{flexShrink:0,ml:2.5}},a.a.createElement(le.a,{onClick:c(0),disabled:0===n,"aria-label":"first page"},a.a.createElement(ue.a,null,i?"last_page":"first_page")),a.a.createElement(le.a,{onClick:c(n-1),disabled:0===n,"aria-label":"previous page"},a.a.createElement(ue.a,null,i?"keyboard_arrow_right":"keyboard_arrow_left")),a.a.createElement(le.a,{onClick:c(n+1),disabled:n>=Math.ceil(t/r)-1,"aria-label":"next page"},a.a.createElement(ue.a,null,i?"keyboard_arrow_left":"keyboard_arrow_right")),a.a.createElement(le.a,{onClick:c(Math.max(0,Math.ceil(t/r)-1)),disabled:n>=Math.ceil(t/r)-1,"aria-label":"last page"},a.a.createElement(ue.a,null,i?"first_page":"last_page")))}function ye(e){var t=e.features,n=(e.assay,Object(r.useState)(0)),o=Object(c.a)(n,2),i=o[0],l=o[1],u=Object(r.useState)(50),s=Object(c.a)(u,2),f=s[0],h=s[1];return a.a.createElement(se.a,null,a.a.createElement(fe.a,{sx:{maxWidth:600,marginTop:2,captionSide:"top"},size:"small","aria-label":"features table"},a.a.createElement(he.a,null,Object(w.a)(Array(f).keys()).map(function(e){return a.a.createElement(pe.a,{key:e},a.a.createElement(me.a,{component:"th",scope:"row"},t[i*f*2+2*e]),Object(w.a)(Array(1).keys()).map(function(n){return a.a.createElement(me.a,{align:"right",key:n},t[i*f*2+2*e+1+n]||"")}))})),a.a.createElement(de.a,null,a.a.createElement(pe.a,null,a.a.createElement(ge.a,{rowsPerPageOptions:[5,15,50],colSpan:3,count:Math.ceil(t.length/2),rowsPerPage:f,page:i,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},onPageChange:function(e,t){return l(t)},onRowsPerPageChange:function(e){h(parseInt(e.target.value,10)),l(0)},ActionsComponent:ve})))))}var be=n(687),Ee=n(864);function we(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Oe(e){var t=e.xys,n=e.colorBy,a=e.selected,o=e.covs,i=e.discreteCovs,l=e.continuousCovs,u=e.contrast,s=e.zTransform,f=e.remoteData;function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!isNaN(e))return e;if(e.startsWith("#")&&(e=function(e){var t;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),"rgba("+[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t].join(",")+",1)";throw new Error("Bad Hex")}(e)),e.startsWith("rgba")){var r=e.slice(5,-1).split(",").slice(0,-1).map(function(e){return Math.max(parseInt(e,10)-n,0)});return null!==t&&r.push(t),"rgba("+r.join()+")"}return null}var p,m=Ee.plottingDefaults,d=m.maxRowsInTooltip,g=m.backgroundOpacity,v=m.backgroundSize,y=m.highlightOpacity,b=m.highlightSize,E=m.highlightBorderWidth,x=m.backgroundBorderWidth,O=(p=v)+(b-p)*u,j=function(e){return G(e.layout)},C=Object(r.useMemo)(function(){var e={colors:null,traceIdxes:null,isContinous:!1};if(null==n)return e;if(""!==n&&n in o&&i.includes(n)){var t=D.d3.scale.category20(),r=Object(w.a)(new Set(o[n])).sort();r.forEach(function(e){return t(e)});var a={};r.forEach(function(e,t){return a[e]=t});var c,u={},s=we(r);try{for(s.s();!(c=s.n()).done;){var h=c.value;u[h]=t(h)}}catch(p){s.e(p)}finally{s.f()}return e.colors=o[n].map(function(e){return t(e)}),e.traces=r.map(function(e){return{idxes:[],name:e}}),o[n].forEach(function(t,n){return e.traces[a[t]].idxes.push(n)}),e}return""!==n&&n in o&&l.includes(n)?(e.colors=o[n],e.isContinous=!0,e):""===n||n in o||null===f?e:(e.colors=f.data,e.isContinous=!0,e)},[n,s,o,f]),L=C.colors,k=Object(r.useMemo)(function(){return null==L?null:L.map(function(e){return h(e,null,40)})},[n,o,f]),S=Object(r.useMemo)(function(){return null==L?null:L.map(function(e){return h(e,.8)})},[n,o,f]),P=Object(r.useMemo)(function(){if(null==o)return null;var e=Object.keys(o).slice(0,d);return 0===e.length?null:o[e[0]].map(function(t,r){if(null!=a&&!a[r])return null;var i="";return""!==n&&n in o?i+="".concat(n,": ").concat(o[n][r],"<br><br>"):""===n||null===n||n in o||null==f||(i+="".concat(n,": ").concat(f.data[r],"<br><br>")),i+=e.map(function(e){return"".concat(e,": ").concat(o[e][r])}).join("<br>")})},[o,n,a,f]),N=Object(r.useMemo)(function(){return null===a?.6:a.map(function(e){return e?y:g})},[a]),I=Object(r.useMemo)(function(){return null===a?6:a.map(function(e){return e?O:v})},[a]),_=Object(r.useMemo)(function(){return null===a?null:a.map(function(e){return e?y:g})},[a]),A=Object(r.useMemo)(function(){return null===a?null:a.map(function(e){return e?E:x})},[a]),M=Object(r.useState)({hovermode:"closest",showlegend:!0,margin:{l:0,r:0,t:0,b:0},legend:{x:1.2,xanchor:"right",y:.95},xaxis:{showline:!1,showgrid:!1,zeroline:!1,showticks:!1,showticklabels:!1},yaxis:{showline:!1,showgrid:!1,zeroline:!1,showticks:!1,showticklabels:!1},autosize:!0}),T=Object(c.a)(M,2),z=T[0],G=T[1],R=C.traces;return{data:null==R?[{x:t[0],y:t[1],type:"scattergl",mode:"markers",marker:{color:L,colorscale:s?"Picnic":null,colorbar:C.isContinous?{title:n,len:.9}:null,size:I,opacity:N,line:{width:A,opacity:_,color:k}},text:P,hoverlabel:{bgcolor:S},hoverinfo:"text",name:""}]:R.map(function(e){return{x:e.idxes.map(function(e){return t[0][e]}),y:e.idxes.map(function(e){return t[1][e]}),type:"scattergl",mode:"markers",marker:{color:e.idxes.map(function(e){return L[e]}),colorscale:s?"Picnic":null,colorbar:C.isContinous?{title:n,len:.9}:null,size:Object(be.isArray)(I)?e.idxes.map(function(e){return I[e]}):I,opacity:Object(be.isArray)(N)?e.idxes.map(function(e){return N[e]}):N,line:{width:null==A?null:e.idxes.map(function(e){return A[e]}),opacity:null==_?null:e.idxes.map(function(e){return _[e]}),color:null==k?null:e.idxes.map(function(e){return k[e]})}},text:e.idxes.map(function(e){return P[e]}),hoverlabel:{bgcolor:null==S?null:e.idxes.map(function(e){return S[e]})},hoverinfo:"text",name:e.name}}),frames:[],config:{displaylogo:!1,modeBarButtonsToRemove:["sendDataToCloud","hoverCompareCartesian","zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","toggleSpikelines"]},layout:z,useResizeHandler:!0,style:{},onInitialized:j,onUpdate:j}}function je(e,t,n){var a,o=t[e.layer],i=o.covs,l=o.discreteCovs,u=o.continuousCovs;switch(e.projection){case"umap":a="UMAP_1"in i?[i.UMAP_1,i.UMAP_2]:[i.umap_1,i.umap_2];break;case"tsne":a="tSNE_1"in i?[i.tSNE_1,i.tSNE_2]:[i.tsne_1,i.tsne_2];break;default:a=[null,null]}var s=function(e){var t=e.covs,n=Object(r.useState)(""),a=Object(c.a)(n,2),o=a[0],i=a[1],l=Object(r.useState)([]),u=Object(c.a)(l,2),s=u[0],f=u[1],h=Object(r.useState)(1),p=Object(c.a)(h,2),m=p[0],d=p[1],g=Object(r.useState)(!1),v=Object(c.a)(g,2),y=v[0],b=v[1];return{selected:Object(r.useMemo)(function(){return null!==s&&s.length>0&&null!==t&&s[0].value.group in t?t[s[0].value.group].map(function(e,n){return s.some(function(e){var r=e.value,a=r.group,o=r.term;return t[a][n]===o})}):null},[s,t]),setColorBy:i,colorBy:o,filter:s,setFilter:f,selectSubpop:function(e){f(e)},contrast:m,setContrast:d,zTransform:y,setZTransform:b}}(t[e.layer]);return[Oe({xys:a,colorBy:s.colorBy,selected:s.selected,covs:i,discreteCovs:l,continuousCovs:u,contrast:s.contrast,zTransform:s.zTransform,remoteData:n}),s]}function Ce(){Ce=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",p="suspendedYield",m="executing",d="completed",g={};function v(){}function y(){}function b(){}var E={};u(E,i,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(I([])));x&&x!==n&&r.call(x,i)&&(E=x);var O=b.prototype=v.prototype=Object.create(E);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=h;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Le(e){var t=e.classes,n=e.settings,o=e.panelDataState,i=e.panelIdx,l=(e.openChooseDataset,e.loadDataPanel),u=e.maximized,s=e.toggleMaximize,f=Object(r.useMemo)(function(){return n.datasets.map(function(e,t){return{value:t,label:e.name}})},[n]),h=(o.status,o.error,o.data),p=h.data,m=h.dataAPI,g=h.genesets,v=h.name,b=Object(r.useState)(!1),w=Object(c.a)(b,2),x=w[0],O=w[1],k={};function P(e){var t=null;if(null!=e&&e.length>0){var n=e.filter(function(e){return e.toLowerCase().includes("default")}),r=e.filter(function(e){return e.toLowerCase().includes("curated")}),a=e.filter(function(e){return e.toLowerCase().includes("prelim")}),o=e.filter(function(e){return e.toLowerCase().includes("main")});n.length>0?t=n[0]:r.length>0?t=r[0]:a.length>0?t=a[0]:o.length>0?t=o[0]:e.length>0&&(t=e[0])}return{value:t,label:t}}p.layers.forEach(function(e){var t=p.layersData[e.id].covs,n=[];("UMAP_1"in t||"umap_1"in t)&&n.push("umap"),("TSNE_1"in t||"tsne_1"in t||"tSNE_1"in t)&&n.push("tsne"),k[e.id]=n});var I={projection:k[p.layers[0].id][0],feature:null,layer:p.layers[0].id,mode:["plot"],modeAssay:Object.keys(g)[0],heatmapMode:"heatmap",clustering:P(p.layersData[p.layers[0].id].clusterings),selectedHeatmapAssay:[null]},_=Object(r.useState)(I),A=Object(c.a)(_,2),M=A[0],G=A[1],R=p.layersData[M.layer].clusterings,F=[{name:"plot",icon:"scatter_plot"}];null!=R&&Object.keys(R).length>0&&F.push({name:"heatmap",icon:"grid_view"}),F.push({name:"legends",icon:"table"});var B=ie({dataAPI:m,dataConfig:M,covs:p.layersData[M.layer].covs}),H=Object(c.a)(B,2),W=H[0],V=H[1],U=je(M,p.layersData,W),Y=Object(c.a)(U,2),q=Y[0],J=Y[1],K=function(){var e=["none","with-select-paint"],t=Object(r.useState)(0),n=Object(c.a)(t,2),a=n[0],o=n[1];return[e[a],function(){o((a+1)%e.length)}]}(),Z=Object(c.a)(K,2),$=Z[0],X=Z[1],Q=k[M.layer],ee=Object(r.useState)(null),ne=Object(c.a)(ee,2),re=ne[0],oe=ne[1];function ce(e,t){O(!1),e.value!==o.data.datasetIdx&&l(e.value,i)}function le(e){if(null!=e&&e.value!=M.clustering.value){var t=Object(y.a)({},M);t.clustering=e,he(null),G(t)}}q.layout.showlegend=u,q.layout.margin.r=0;var ue=Object(r.useState)(null),se=Object(c.a)(ue,2),fe=se[0],he=se[1],pe=Object(r.useState)(!0),me=Object(c.a)(pe,2),de=me[0],ge=me[1],ve=Object(r.useState)(!0),be=Object(c.a)(ve,2),Ee=be[0];be[1];Object(r.useEffect)(function(){if(null!=M.clustering&&null!==M.clustering.value){var e="".concat(p.url,"/").concat(M.layer,"/clustering/").concat(M.clustering.value).concat(Ee?"/true":"");ge(!0),function(){var t=Object(E.a)(Ce().mark(function t(){var n;return Ce().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return t.next=5,t.sent.json();case 5:if((n=t.sent)&&0!==Object.keys(n).length){t.next=8;break}throw new Error("Empty response from server.");case 8:he(n),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("Failed fetching data from ".concat(e,". ").concat(t.t0)),alert("Failed fetching data from ".concat(e,". ").concat(t.t0));case 15:return t.prev=15,console.log("finally"),ge(!1),t.finish(15);case 19:case"end":return t.stop()}},t,null,[[0,11,15,19]])}));return function(){return t.apply(this,arguments)}}()()}},[M.clustering]);var we,xe=M.selectedHeatmapAssay;if(xe=Array.isArray(xe)&&xe.length>0?xe:[xe],fe){var Oe=Object.keys(fe),Le=u?Oe:[Oe.pop()];Oe.includes("markers")?xe=[null]:(we=xe,xe=(u?we.some(function(e){return!Oe.includes(e)}):we.length>1||!Oe.includes(we[0]))?Le:xe)}function ke(e){null!=e&&function(e){var t=Object(y.a)({},M,{selectedHeatmapAssay:e});G(t)}(e)}function Se(){return F.filter(function(e){return M.mode.includes(e.name)}).map(function(e){return e.name})}function Pe(){return x?a.a.createElement(d.d,{className:t.chooseDatasetControl,variant:"outlined"},a.a.createElement(te,{classes:t,options:f,value:{value:o.data.datasetIdx,label:o.data.name},onChange:ce,defaultMenuIsOpen:!0,onMenuClose:function(){O(!1)},placeholder:"Select "})):a.a.createElement(a.a.Fragment,null,a.a.createElement(d.g,{color:"primary",onClick:function(){return O(!0)}},a.a.createElement(d.f,null,"folder")),a.a.createElement("span",null,a.a.createElement("i",null,v)))}function Ne(){var e=M.heatmapMode,n=M.clustering,r=M.layer,o=Se().includes("heatmap");if(!o)return null;var i={margin:"0px",top:0,marginLeft:Se().includes("plot")|!u?"0px":"300px"},c=!de&&o,l=!de&&"none"!==$&&fe&&!Object.keys(fe).includes("markers");return a.a.createElement(d.e,{item:!0,xs:Me*xe.length,className:t.plot,style:{overflowY:"scroll"}},"none"!==$&&a.a.createElement("div",{className:u?t.floatingControls:t.fixedControls,style:i},a.a.createElement(d.d,{className:t.parintControl,variant:"outlined"},a.a.createElement(te,{classes:t,options:R.map(function(e){return{value:e,label:e}}),value:n,onChange:le,placeholder:"Select"})),c&&a.a.createElement(j.a,{style:{margin:"0px",top:0,marginLeft:"100px"},color:"primary",value:e,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(y.a)({},M);t.heatmapMode=e,G(t)}}(t)}},a.a.createElement(C.a,{key:"toggleHeatmapMode-plot",value:"heatmap"},"HEATMAP"),a.a.createElement(C.a,{key:"toggleHeatmapMode-markers-table",value:"markers-table"},"MARKERS")),l&&a.a.createElement(j.a,{style:{margin:"0px",top:0,marginLeft:"20px"},color:"primary",value:xe,exclusive:!u,onChange:function(e,t){return ke(t)}},Object.keys(fe).map(function(e,t){return a.a.createElement(C.a,{key:"toggleSelectedHeatmapAssay-".concat(t),value:e},e)}))),a.a.createElement("div",{style:{marginTop:50,width:"100%"}},de&&a.a.createElement(L.a,{sx:{display:"flex",justifyContent:"center"}},a.a.createElement(z.a,null)),!de&&fe&&a.a.createElement(d.e,{container:!0},(xe||[null]).map(function(t,o){return a.a.createElement(d.e,{item:!0,key:"heatmapContainer_".concat(o),xs:12/xe.length},"heatmap"===e&&a.a.createElement(N,{data:fe,usingFullMatrix:Ee,clustering:n.value,layer:r,heatmapAssayInEffect:t,sNHControls:$,maxWidth:Math.floor(1600/12*Me/(u?1:3))}),"markers-table"===e&&a.a.createElement(T,{clusteringData:fe,selectedHeatmapAssay:t,maxWidth:Math.floor(1600/12*Me/(u?1:3))}))}))))}var Ie=M.mode.includes("plot"),_e=M.mode.includes("legends"),Ae=Se(),Me=Ae.includes("heatmap")?12/(Ae.length+xe.length-1):12/Ae.length,Te=Ie||M.mode.includes("heatmap"),De={margin:"5px"};function ze(){if("none"===$)return null;return a.a.createElement(d.e,{container:!0,className:t.toggleProjection},a.a.createElement(j.a,{style:De,color:"primary",value:M.mode,exclusive:!u,onChange:function(e,t){return function(e){if(null!=e){var t=Object(y.a)({},M);t.mode=e,G(t)}}(t)}},F.map(function(e){return a.a.createElement(C.a,{"data-test-id":"mode-type",key:"mode_".concat(e.name),value:e.name},a.a.createElement(d.f,null,e.icon))})),null,Ie&&a.a.createElement(j.a,{style:De,color:"primary",value:M.projection,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(y.a)({},M);t.projection=e,G(t)}}(t)}},Q.map(function(e){return a.a.createElement(C.a,{"data-test-id":"projection-type",key:"toggleProjection".concat(e),value:e},e)})),Te&&a.a.createElement(j.a,{style:De,color:"primary",value:M.layer,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(y.a)({},M);t.layer=e,t.clustering=P(p.layersData[e].clusterings),he(null),G(t)}}(t)}},p.layers.map(function(e){return a.a.createElement(C.a,{"data-test-id":"layer-type",key:"layer_".concat(e.id),value:e.id},e.name)})))}return a.a.createElement(d.j,{className:t.paper},a.a.createElement(d.e,{container:!0,className:t.headerPanel,alignItems:"center"},a.a.createElement(Pe,null)),Ie&&a.a.createElement("div",{className:t.floatingControls},a.a.createElement(ae,{classes:t,covs:p.layersData[M.layer].covs,features:p.meta.features,continuousCovs:p.layersData[M.layer].continuousCovs,discreteCovs:p.layersData[M.layer].discreteCovs,brushing:J,genesets:g,remoteData:W,loadRemoteData:V,sNHControls:$})),a.a.createElement(d.e,{container:!0,className:t.plotMain,spacing:0},Ie&&a.a.createElement(d.e,{item:!0,xs:Me,className:t.plot},a.a.createElement(S.a,{className:t.plot,data:q.data,layout:q.layout,config:q.config,useResizeHandler:q.useResizeHandler,onInitialized:function(e,t){return oe(t)},onUpdate:function(){return D.newPlot(re,q.data,q.layout,q.config)},onWebGlContextLost:function(){return D.newPlot(re,q.data,q.layout,q.config)}})),a.a.createElement(ze,null),a.a.createElement(Ne,null),_e&&a.a.createElement(d.e,{item:!0,xs:Me,className:t.plot,style:{overflowY:"scroll"}},a.a.createElement(ye,{className:t.plot,style:{overflow:"scroll"},features:g,maxWidth:Math.floor(1600/12*Me/(u?1:3)),assay:M.modeAssay}))),a.a.createElement(d.e,{container:!0,className:t.footerPanel,alignItems:"center"},a.a.createElement("div",{style:{margin:"auto"}},a.a.createElement(d.g,{onClick:s,color:"primary"},a.a.createElement(d.f,null,"view_column")),a.a.createElement(d.g,{onClick:X,color:"primary"},a.a.createElement(d.f,null,function(){switch($){case"none":case"with-select-paint":return"fullscreen_exit";case"with-select-paint-geneset":return"fullscreen";default:return null}}())),p.zip&&a.a.createElement(d.g,{style:{marginLeft:"20px"},onClick:function(){window.open("report/".concat(p.zip))},color:"primary"},a.a.createElement(d.f,null,"download")))))}var ke=Object(b.withStyles)(function(e){return{root:{flexGrow:1,height:"100%",width:"100%"},input:{display:"flex",padding:0},title:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,marginTop:0,marginBottom:0,wordWrap:"break-word"},card:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},paper:{height:"100%",width:"100%"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},floatingControls:{position:"absolute",zIndex:10},fixedControls:{zIndex:10},controlArea:{},center:{position:"absolute",top:"50%",left:"30%",right:"30%",backgroundColor:"white",marginLeft:"auto",marginRight:"auto",padding:"20px",zIndex:100},plotMain:{height:"calc(100vh - 6em)",width:"100%"},plot:{height:"100%",width:"calc(100% - 5px)"},toggleProjection:{position:"absolute",width:"30%",bottom:"40px",zIndex:200},footer:{position:"absolute",width:"100%",marginBottom:"0px",padding:"0px",bottom:"0px",fontSize:"0.8em",zIndex:10},headerPanel:{whiteSpace:"nowrap",margin:"0px",minHeight:"48px",padding:"0px",align:"left",top:"0px",fontSize:"0.8em",zIndex:10},footerPanel:{whiteSpace:"nowrap",marginBottom:"0px",padding:"0px",align:"center",bottom:"0px",fontSize:"0.8em",zIndex:10},chooseDatasetControl:{position:"absolute",top:1,marginLeft:1,zIndex:300},searchControl:{margin:e.spacing.unit,minWidth:100,maxWidth:300},paintControl:{margin:e.spacing.unit,minWidth:100,maxWidth:300},paintGenesetControl:{margin:e.spacing.unit,minWidth:100,maxWidth:300}}})(function(e){var t=e.classes,n=e.settings,o=e.initialDatasetIdx,i=O({datasets:n.datasets,initialDatasetIdx:o,nPanels:3}),l=Object(c.a)(i,2),u=l[0],s=l[1],f=Object(r.useState)(0),h=Object(c.a)(f,2),p=h[0],m=h[1];function g(e){null!=e&&m(e)}return a.a.createElement(d.e,{container:!0,className:t.root,spacing:0},-1===p?Array(3).fill(0).map(function(e,r){return a.a.createElement(d.e,{key:"scpanel_".concat(r),item:!0,xs:4},null===u[r].data?"Loading":a.a.createElement(Le,{classes:t,settings:n,panelDataState:u[r],panelIdx:r,loadDataPanel:s,maximized:!1,toggleMaximize:function(){return g(r)}}))}):a.a.createElement(d.e,{item:!0,xs:12},null===u[p].data?"Loading":a.a.createElement(Le,{settings:n,classes:t,panelDataState:u[p],panelIdx:p,loadDataPanel:s,maximized:!0,toggleMaximize:function(){return g(-1)}})))}),Se=(n(2044),n(2011),n(2060),n(2035),n(2031),n(2028),n(370)),Pe=n.n(Se),Ne=n(369),Ie=n.n(Ne),_e=Object(b.withStyles)(function(e){return{root:{width:"70%",backgroundColor:e.palette.background.paper,paddingLeft:"50px",margin:"0 auto"},searchInput:{marginBottom:"16px",width:"100%"},tableRow:{"&:hover":{backgroundColor:e.palette.background.paper},cursor:"pointer"},stickyHeader:{position:"sticky",top:0,backgroundColor:e.palette.background.paper,zIndex:1},table:{width:"70%",margin:"0 auto"},tableCell:{padding:"4px 8px",wordWrap:"break-word"}}})(function(e){var t=e.classes,n=e.title,o=e.datasets,i=e.versions,l=(e.onGroupClick,e.onDatasetSelect),u=void 0===l?function(){}:l,s=Object(r.useState)("grab"),f=Object(c.a)(s,2),h=(f[0],f[1]),p=Object(r.useState)(""),m=Object(c.a)(p,2),g=m[0],b=m[1],E=Object(r.useState)({}),w=Object(c.a)(E,2),x=w[0],O=w[1],j=function(e){h("wait"),u(e)},C=o.map(function(e){return Object(y.a)({},e,{organ:e.organ||""})}).sort(function(e,t){return"multiome"===e.name?-1:"multiome"===t.name?1:e.organ?t.organ?e.organ<t.organ?-1:e.organ>t.organ?1:0:-1:1}).reduce(function(e,t){var n=t.organ,r=t.displayName,a=t.isGroup,o=t.datasets,i=new RegExp(g,"i"),c=i.test(n),l=i.test(r);if(a)if(g){var u=o.filter(function(e){return i.test(e.name)});(c||l||u.length>0)&&e.push({organ:n,displayName:r,isGroup:a,datasets:u.length>0?u:o,expanded:!0})}else e.push({organ:n,displayName:r,isGroup:a,datasets:o,expanded:x[r]||!1});else(c||l)&&e.push({organ:n,displayName:r,isGroup:a,datasets:o,expanded:x[r]||!1});return e},[]);return a.a.createElement("div",{className:t.root},a.a.createElement(Ie.a,{id:"draggable-dialog-title"},n),a.a.createElement(d.s,{className:t.searchInput,label:"Search by organ or dataset name",variant:"outlined",value:g,onChange:function(e){b(e.target.value.toLowerCase())}}),a.a.createElement(d.m,{className:t.table},a.a.createElement(d.p,null,a.a.createElement(d.q,{className:t.stickyHeader},a.a.createElement(d.o,null,"organ/site"),a.a.createElement(d.o,null,"dataset"),a.a.createElement(d.o,null,"layers"),a.a.createElement(d.o,null,"modalities"))),a.a.createElement(d.n,null,C.map(function(e,n){var o=e.displayName,i=e.organ,c=e.name,l=e.layers,u=e.modalities,s=e.isGroup,f=e.datasets,h=e.expanded;return a.a.createElement(r.Fragment,{key:n},a.a.createElement(d.q,{className:t.tableRow,hover:!0,onClick:function(){var e;s?(e=o,O(function(t){return Object(y.a)({},t,Object(v.a)({},e,!t[e]))})):j(n)}},a.a.createElement(d.o,null,s?i:""),a.a.createElement(d.o,null,s?"".concat(h?"-":"+"," ").concat(o):c),a.a.createElement(d.o,null,s?"":l.length),a.a.createElement(d.o,null,s?"":u.length)),s&&h&&f.map(function(e,r){return a.a.createElement(d.q,{key:"".concat(n,"-").concat(r),className:t.tableRow,hover:!0,onClick:function(){return j(e.originalIndex)}},a.a.createElement(d.o,null,"")," ",a.a.createElement(d.o,{style:{paddingLeft:"30px"}},e.name),a.a.createElement(d.o,null,e.layers.length),a.a.createElement(d.o,null,e.modalities.length))}))}))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(Pe.a,null),a.a.createElement("br",null),a.a.createElement("span",{className:t.buildInfo},"ISCVAM v",i.version,", \xa0\xa0 revision ",i.revision,"\xa0\xa0\xa0\xa0\xa0",a.a.createElement("a",{href:"https://medicine.utah.edu/internal-medicine/epidemiology/chen-lab"},a.a.createElement("i",null,"Created by Chen Lab"))))}),Ae={version:"0.1.0",revision:"342ef43",branch:"public"},Me=Object.entries({Bladder:["BLCA"],Blood:["AEL","AML","ALL","CLL","PBMC","multiome PBMC"],Bone:["MM","GCTB","OS"],Brain:["Glioma","MB","multiome human brain 3k"],Breast:["BRCA"],Colorectum:["CRC"],Esophagus:["ESCA"],Eye:["RB","UVM"],"Head & Neck":["HNSC","THCA","LSCC","NPC","OSCC"],Kidney:["KIRC","KICH","KIPAN"],Liver:["CHOL","LIHC","HB"],Lung:["NSCLC","SCLC"],"Lymph node":["NHL","DLBC"],"Nervous system":["MPNST","NET","NB","Neurofibroma"],Pancreas:["PAAD"],"Pelvic cavity":["CESC","OV","UCEC","multiome discovery","multiome int.validation"],Prostate:["PRAD"],Skin:["BCC","MCC","MF","PCFCL","SCC","SKCM","GSE189341-acral-sc-seuratV5","Acral melanoma CCR 2022"],"Soft tissue":["GIST","SARC","PPB","SS"],Stomach:["STAD"]}).reduce(function(e,t){var n=Object(c.a)(t,2),r=n[0];return n[1].forEach(function(t){e[t]=r}),e},{}),Te=Object(b.withStyles)(function(e){return{fab:{margin:e.spacing.unit,position:"absolute",right:"10px",bottom:"10px",zIndex:100},fab2:{margin:e.spacing.unit,position:"absolute",right:"100px",bottom:"10px",zIndex:200}}})(function(e){var t=e.onDatasetClick,n=e.onShowHeader,o=(e.classes,Object(r.useState)({settings:null,initialDatasetIdx:null,groupedDatasets:{},expandedGroups:{}})),i=Object(c.a)(o,2),l=i[0],u=i[1];Object(r.useEffect)(function(){return fetch("app-settings.json").then(function(e){return e.json()}).then(function(e){var t=function(e){var t={};return e.forEach(function(e,n){var r=(e.name||"").split("_")[0];t[r]||(t[r]=[]),t[r].push(Object(y.a)({},e,{originalIndex:n}))}),t}(e.datasets);u(function(n){return Object(y.a)({},n,{settings:e,groupedDatasets:t})})}),window.addEventListener("popstate",s),function(){window.removeEventListener("popstate",s)}},[]);var s=function(){n(),u(function(e){return Object(y.a)({},e,{initialDatasetIdx:null})})};return a.a.createElement("div",{className:"App"},null===l.initialDatasetIdx?a.a.createElement("div",null,a.a.createElement("p",{style:{fontSize:"16px",margin:"20px 240px",textAlign:"center"}},a.a.createElement("strong",null,"ISCVAM")," is a fast, interactive tool for analyzing scRNA-seq and multimodal datasets, ",a.a.createElement("br",null),"including ",a.a.createElement("strong",null,"6,300,000+")," single cells across ",a.a.createElement("strong",null,"198")," studies (190 from TISCH). It\u2019s built in JavaScript for smooth visualization and analysis."),a.a.createElement(_e,{onDatasetSelect:function(e){t(),u(function(t){return Object(y.a)({},t,{initialDatasetIdx:e})}),window.history.pushState(null,"","")},datasets:Object.keys(l.groupedDatasets).map(function(e){return{displayName:"".concat(e," (").concat(l.groupedDatasets[e].length,")"),organ:Me[e],name:e,layers:[],modalities:[],reference:null,isGroup:!0,datasets:l.groupedDatasets[e],expanded:l.expandedGroups[e]||!1}}),versions:Ae,onGroupClick:function(e){u(function(t){return Object(y.a)({},t,{expandedGroups:Object(y.a)({},t.expandedGroups,Object(v.a)({},e,!t.expandedGroups[e]))})})}})):a.a.createElement("div",null,a.a.createElement(ke,{settings:l.settings,initialDatasetIdx:l.initialDatasetIdx})))}),De=function(){var e="".concat("/iscvam","/ISCVAM_tutorial_2024-09-24.pdf");return a.a.createElement("div",{style:{textAlign:"center",padding:"20px"}},a.a.createElement("iframe",{src:e,width:"100%",height:"1000px",style:{border:"none",background:"none"},title:"Tutorial PDF"},"Your browser doesn\u2019t support iframes."," ",a.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},"Download the PDF here"),"."))},ze=n(2061),Ge=n(2050),Re=n(2040),Fe=n(2047),Be=n(2032),He=n(2021),We=function(){return a.a.createElement(ze.a,{maxWidth:"md"},a.a.createElement(L.a,{my:4},a.a.createElement(Ge.a,{variant:"body1",paragraph:!0},a.a.createElement("em",null,"ISCVAM: ",a.a.createElement("b",null,"I"),"nteractive ",a.a.createElement("b",null,"S"),"ingle ",a.a.createElement("b",null,"C"),"ell ",a.a.createElement("b",null,"V"),"isual ",a.a.createElement("b",null,"A"),"nalytics for ",a.a.createElement("b",null,"M"),"ultiomics"),", is an interactive tool for analyzing and visualizing single cell multimodal data with multi-resolutions. It is deployed at"," ",a.a.createElement(Re.a,{href:"https://iscvam.moffitt.org/"},"https://iscvam.moffitt.org/"),", and ",a.a.createElement(Re.a,{href:"https://chenlab.utah.edu/iscvam/"},"https://chenlab.utah.edu/iscvam/"),". More than 6.3+ million single cells from ~200 cancer studies with are processes available for investigation at ",a.a.createElement(Re.a,{href:"https://chenlab.utah.edu/iscvam/"},"https://chenlab.utah.edu/iscvam/"),"."),a.a.createElement(Ge.a,{variant:"body1",paragraph:!0},a.a.createElement("em",null,"ISCVAM")," is expanded from ",a.a.createElement("em",null,"ISCVA"),", previously developed for analyzing scRNA-seq data. The information was described in this paper."),a.a.createElement(Ge.a,{variant:"body1",paragraph:!0},"Smalley J, Chen Z, Phadke M, Li J, Yu X, Wyatt C, Evernden B, Messina JL, Sarnaik AA, Sondak VK, Zhang C, Law V, Tran N, Etame A, Macaulay RJB, Eroglu Z, Forsyth PA, Rodriguez PC, Chen YA, Smalley KSM."," ",a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/34035069/"},"Single-Cell Characterization of the Immune Microenvironment of Melanoma Brain and Leptomeningeal Metastases.")," ","Clin Cancer Res. 2021 Jul 15;27(14):4109-4125."),a.a.createElement(Ge.a,{variant:"h5",component:"h2",gutterBottom:!0},"Major Components"),a.a.createElement(Fe.a,null,a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:"1. A collection of Bash and R scripts using widely used algorithms in the single-cell community:",secondary:a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/29608179/"},"Seurat")," for general processing"),a.a.createElement("li",null,a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/30643263/"},"SingleR")," for cell-type recognition"),a.a.createElement("li",null,a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/31294801/"},"Single-cell signature explorer")," for gene set signature scoring"))})),a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:"2. A web-based component using modern technologies like React.js, TensorFlow.js, and Plotly.js.",secondary:"This component allows real-time interactive exploration, backed by an HPC Node.js backend.(A note on web-browser: ISCVAM is currently available on all web browsers, except for Safari)"}))),a.a.createElement(Ge.a,{variant:"h5",component:"h2",gutterBottom:!0},"Publications with data analyzed using ISCVA/ISCVAM:"),a.a.createElement(Fe.a,null,a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/38056899/"},"Differential requirements for CD4+ T cells in the efficacy of the anti-PD-1+LAG-3 and anti-PD-1+CTLA-4 combinations in melanoma flank and brain metastasis models.")})),a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/33653716/"},"Targeted Therapy Given after Anti-PD-1 Leads to Prolonged Responses in Mouse Melanoma Models through Sustained Antitumor Immunity.")})),a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/34035069/"},"Single-Cell Characterization of the Immune Microenvironment of Melanoma Brain and Leptomeningeal Metastases.")})),a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/35247927/"},"Single cell characterization of the cellular landscape of acral melanoma identifies novel targets for immunotherapy.")})),a.a.createElement(Be.a,null,a.a.createElement(He.a,{primary:a.a.createElement(Re.a,{href:"https://pubmed.ncbi.nlm.nih.gov/35213727/"},"A preclinical model of patient-derived cerebrospinal fluid circulating tumor cells for experimental therapeutics in leptomeningeal disease from melanoma.")}))),a.a.createElement(L.a,{mt:2,mb:2},a.a.createElement(Ge.a,{variant:"body2",color:"textSecondary"},a.a.createElement(Re.a,{href:"https://medicine.utah.edu/internal-medicine/epidemiology/chen-lab",target:"_blank",rel:"noopener noreferrer",color:"inherit",underline:"hover"},"Created by Chen Lab")))))},Ve=n(2024);function Ue(){Ue=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var h="suspendedStart",p="suspendedYield",m="executing",d="completed",g={};function v(){}function y(){}function b(){}var E={};u(E,i,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(I([])));x&&x!==n&&r.call(x,i)&&(E=x);var O=b.prototype=v.prototype=Object.create(E);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=h;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}var Ye=function(){var e=Object(r.useState)({name:"",email:"",message:""}),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)({}),l=Object(c.a)(i,2),u=l[0],s=l[1],f=Object(r.useState)(!1),h=Object(c.a)(f,2),p=h[0],m=h[1],g=Object(r.useState)(!1),b=Object(c.a)(g,2),w=b[0],x=b[1],O=Object(r.useState)([]),j=Object(c.a)(O,2),C=(j[0],j[1]),L=function(e){var t=e.target,r=t.name,a=t.value;o(Object(y.a)({},n,Object(v.a)({},r,a)))},k=function(){var e={};return n.name||(e.name="Name is required"),n.email?/\S+@\S+\.\S+/.test(n.email)||(e.email="Email address is invalid"):e.email="Email is required",n.message||(e.message="Message is required"),e},S=function(){var e=Object(E.a)(Ue().mark(function e(t){var r;return Ue().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=k(),0!==Object.keys(r).length){e.next=18;break}return s({}),e.prev=4,e.next=7,Ve.a.post("https://chenlab.chpc.utah.edu/iscvam/backend/api/save-message",n);case 7:m(!0),o({name:"",email:"",message:""}),P(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.error("Error saving message:",e.t0),x(!0);case 16:e.next=19;break;case 18:s(r);case 19:case"end":return e.stop()}},e,null,[[4,12]])}));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(E.a)(Ue().mark(function e(){var t;return Ue().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ve.a.get("https://chenlab.chpc.utah.edu/iscvam/backend/api/messages");case 3:t=e.sent,C(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching messages:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)(function(){P()},[]),a.a.createElement("div",{style:{maxWidth:"600px",margin:"0 auto",padding:"20px"}},a.a.createElement("form",{onSubmit:S,noValidate:!0},a.a.createElement(d.u,{variant:"h5",gutterBottom:!0},"Contact Us"),a.a.createElement(d.s,{label:"Name",name:"name",fullWidth:!0,variant:"outlined",value:n.name,onChange:L,error:!!u.name,helperText:u.name,margin:"normal"}),a.a.createElement(d.s,{label:"Email",name:"email",type:"email",fullWidth:!0,variant:"outlined",value:n.email,onChange:L,error:!!u.email,helperText:u.email,margin:"normal"}),a.a.createElement(d.s,{label:"Message",name:"message",fullWidth:!0,variant:"outlined",multiline:!0,rows:4,value:n.message,onChange:L,error:!!u.message,helperText:u.message,margin:"normal"}),a.a.createElement(d.b,{type:"submit",variant:"contained",color:"primary",style:{marginTop:"20px"}},"Send Message"),a.a.createElement(d.k,{open:p,autoHideDuration:4e3,onClose:function(){return m(!1)},message:"Message saved successfully!"}),a.a.createElement(d.k,{open:w,autoHideDuration:4e3,onClose:function(){return x(!1)},message:"Failed to save the message."})))},qe=Object(l.a)({palette:{primary:s.a,secondary:f.a,error:h.a,contrastThreshold:3,tonalOffset:.2},typography:{useNextVariants:!0}}),Je=function(){var e=Object(r.useState)(!0),t=Object(c.a)(e,2),n=t[0],o=t[1];return a.a.createElement(u.a,{theme:qe},a.a.createElement(p.a,{basename:"/iscvam"},n&&a.a.createElement(g,null),a.a.createElement(m.c,null,a.a.createElement(m.a,{index:!0,element:a.a.createElement(Te,{onDatasetClick:function(){o(!1)},onShowHeader:function(){o(!0)}})}),a.a.createElement(m.a,{path:"tutorial",element:a.a.createElement(De,null)}),a.a.createElement(m.a,{path:"about",element:a.a.createElement(We,null)}),a.a.createElement(m.a,{path:"contact",element:a.a.createElement(Ye,null)}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(1930);i.a.render(a.a.createElement(Je,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},864:function(e){e.exports={tsneComputationDefaults:{perplexity:16,npcs:60,maxPerplexity:39,minPerplexity:1},plottingDefaults:{maxRowsInTooltip:10,highlightOpacity:.5,highlightSize:8,backgroundOpacity:.3,backgroundSize:2,highlightBorderWidth:1,backgroundBorderWidth:0}}},958:function(e,t,n){e.exports=n(1874)},963:function(e,t,n){},965:function(e,t,n){}},[[958,2,1]]]);
//# sourceMappingURL=main.9eb66a11.chunk.js.map