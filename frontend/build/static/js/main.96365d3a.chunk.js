(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1395:function(e,t){},1826:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(49),i=n.n(o),c=(n(851),n(853),n(80)),l=n(488),u=n.n(l),s=n(489),f=n.n(s),p=n(490),h=n.n(p),m=n(3),d=n(7),g=n(71),y=n(29),v=n(50),b=n(23);function x(){x=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new _(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",h="suspendedYield",m="executing",d="completed",g={};function y(){}function v(){}function b(){}var E={};u(E,i,function(){return this});var w=Object.getPrototypeOf,O=w&&w(w(I([])));O&&O!==n&&r.call(O,i)&&(E=O);var j=b.prototype=y.prototype=Object.create(E);function C(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function L(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function k(t,n,r){var a=p;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=S(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function S(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return v.prototype=b,a(j,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},C(L.prototype),u(L.prototype,c,function(){return this}),t.AsyncIterator=L,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new L(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},C(j),u(j,l,"Generator"),u(j,i,function(){return this}),u(j,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function E(e){var t=e.datasets,n=e.initialDatasetIdx,a=e.nPanels,o={},i=Object(r.useRef)(o);console.log("Initial Cache: ",o);var c=Object(b.a)(Array(a)).map(function(){return{data:null}});console.log("Initial Cache: ",o);var l=Object(r.useReducer)(function(e,t){var n=t.type,r=Object(b.a)(e);switch(n){case"FETCHING":var a=r[t.panelIdx];null!==a.data&&((o=a.data.datasetIdx)in i.current&&delete i.current[o]),a.data=null;break;case"FETCHED":case"FETCH_ERROR":break;case"LOAD_PANEL":r[t.panelIdx].data=i.current[t.datasetIdx].store,i.current[t.datasetIdx].rc++;break;case"LOAD_ALL_PANELS":console.log("Action datasetIdx:",t.datasetIdx),console.log("Cache current:",i.current),i.current[t.datasetIdx]?(r.forEach(function(e){return e.data=i.current[t.datasetIdx].store}),i.current[t.datasetIdx].rc=r.length):(console.error("Invalid datasetIdx: ".concat(t.datasetIdx)),console.error("Cache current:",i.current));break;default:throw new Error}var o;return r},c),u=Object(d.a)(l,2),s=u[0],f=u[1];function p(e,t,n,r){var a={};a.covs=e.covs,a.continuousCovs=e.continuousCovs,a.discreteCovs=e.discreteCovs,a.clusterings=r,n.layersData[t.id]=a}function h(e){return m.apply(this,arguments)}function m(){return(m=Object(v.a)(x().mark(function e(n){var r,a,o,c,l,u,s,f,h;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n||0===n){e.next=2;break}return e.abrupt("return",null);case 2:if(i.current[n]){e.next=17;break}return e.prev=3,r=t[n],a=r.name,o=r.url,c=r.layers,l=r.modalities,u=r.zip,s={layers:c,modalities:l,name:a,url:o,zip:u,layersData:{}},(f=c.map(function(){var e=Object(v.a)(x().mark(function e(t){var n,r,a,i,c;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o in t?t.url:"".concat(o,"/").concat(t.id),e.next=3,fetch(n);case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,i="".concat(n,"/clusterings"),e.next=10,fetch(i);case 10:return e.next=12,e.sent.json();case 12:c=e.sent,p(a,t,s,c);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())).push(Object(v.a)(x().mark(function e(){var t;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/meta"));case 2:return t=e.sent,e.next=5,t.json();case 5:s.meta=e.sent;case 6:case"end":return e.stop()}},e)}))()),f.push(Object(v.a)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/genesets"));case 2:return e.next=4,e.sent.json();case 4:h=e.sent;case 5:case"end":return e.stop()}},e)}))()),e.next=11,Promise.all(f);case 11:i.current[n]={store:{data:s,name:a,genesets:h,dataAPI:o,datasetIdx:n},rc:0},e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(3),e.abrupt("return",null);case 17:case"end":return e.stop()}},e,null,[[3,14]])}))).apply(this,arguments)}function g(){return(g=Object(v.a)(x().mark(function e(t,n){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f({type:"FETCHING",panelIdx:n}),e.next=3,h(t);case 3:f({type:"LOAD_PANEL",panelIdx:n,datasetIdx:t});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(r.useEffect)(function(){(function(){var e=Object(v.a)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(n);case 2:f({type:"LOAD_ALL_PANELS",datasetIdx:n});case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[t,n,a]),[s,function(e,t){return g.apply(this,arguments)}]}var w=n(1983),O=n(1987),j=n(1982),C=n(337),L=n.n(C),k=n(1976);var S=function(e){var t=e.data,n=e.clustering,o=e.heatmapAssayInEffect,i=e.usingFullMatrix,c=e.sNHControls,l=e.layer,u=o,s=Object(r.useState)(i?"allAvgsContrast":"avgsContrast"),f=Object(d.a)(s,2),p=f[0],h=f[1],m=Object(r.useState)(1e3),g=Object(d.a)(m,2),y=g[0],v=g[1],b=Object(r.useState)(1e3),x=Object(d.a)(b,2),E=x[0],C=x[1],S=Object(r.useState)(null),P=Object(d.a)(S,2),N=P[0],_=P[1],I=Object(r.useState)(""),A=Object(d.a)(I,2),M=A[0],D=A[1],T="".concat(l," - ").concat(n," - ").concat(u," -").concat(p.includes("Contrast")?"Contrast":"LogNorm"),z=Object(r.useMemo)(function(){if(t&&p&&(null===u&&Object.keys(t).includes("markers")||null!==u&&Object.keys(t).includes(u)))return function(){var e=null==u?t[p]:t[u][p],n=null!==N?N:null!==u?t[u].heatmapMarkers:t.heatmapMarkers;n=n.map(function(e){return e.toLowerCase()});var r=null!==u?t[u].clusterNames:t.clusterNames,a=new Set(n),o=Object.fromEntries(n.map(function(e,t){return[e,t]})),i=e.find(function(e){return Array.isArray(e)}),c=new Set,l=i.reduce(function(e,t,n){return!c.has(t)&&a.has(t.toLowerCase())&&(e.push({item:t,index:n}),c.add(t)),e},[]).sort(function(e,t){return o[e.item.toLowerCase()]-o[t.item.toLowerCase()]}),s=l.map(function(e){return e.item}),f=e.slice(1).map(function(e,t){return l.map(function(t){return e[t.index]})}),h=r,m=s,d=f.reduce(function(e,t){return t.map(function(n,r){return(e[r]||[]).concat(t[r])})},[]),g=d.length<30?d.length<3?100*d.length+300:50*d.length+300:17*d.length,y=300+(h.length<20?h.length<3?100*h.length:36*h.length:20*h.length);return v(g),C(y),{x:h,y:m,z:d}}()},[p,u,N]);return a.a.createElement(a.a.Fragment,null,t&&z&&a.a.createElement(j.a,{style:{width:"100%"}},"none"!==c&&a.a.createElement(a.a.Fragment,null,a.a.createElement(w.a,{style:{display:"block"},color:"primary",onChange:function(e,t){var n;(n=t)&&n!==p&&h(n)},value:p,exclusive:!0},a.a.createElement(O.a,{"data-test-id":"avgsContrast",key:"avgsContrast-heatmap",value:i?"allAvgsContrast":"avgsContrast"},"CONTRAST"),a.a.createElement(O.a,{"data-test-id":"avgsLogNorm",key:"toggleavgsLogNorm-heatmap",value:i?"allAvgsLogNorm":"avgsLogNorm"},"LOGNORM")),a.a.createElement(j.a,null,a.a.createElement(k.a,{sx:{margin:"20px",width:"400px"},placeholder:"Enter gene labels...",multiline:!0,minRows:4,maxRows:10,onChange:function(e){D(e.target.value)},value:M}),a.a.createElement("br",null),a.a.createElement(w.a,{style:{display:"block"},color:"primary"},a.a.createElement(O.a,{"data-test-id":"selectGenesButton",onClick:function(){_(M.split("\n"))},value:"A"},"SELECT GENES"),a.a.createElement(O.a,{"data-test-id":"resetGenesButton",onClick:function(){_(null),D("")},value:"B"},"RESET")))),a.a.createElement(j.a,{sx:{margin:"10px"}},T),a.a.createElement(j.a,{sx:{minHeight:"1000px",width:"100%"}},a.a.createElement(L.a,{data:[{x:z.x,y:z.y,z:z.z,type:"heatmap",colorscale:"Viridis"}],config:{displaylogo:!1,modeBarButtonsToRemove:["sendDataToCloud","hoverCompareCartesian","zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","toggleSpikelines"]},layout:{height:y,width:E,margin:"auto",xaxis:{side:"top",tickangle:35,showticklabels:!0,automargin:!0},yaxis:{autotick:!0,autorange:"reversed",automargin:!0,autoshift:!0}}}))))},P=n(1968),N=n(396),_=n(1970),I=n(1980);function A(e){var t=e.clusteringData,n=e.selectedHeatmapAssay,o=null===n?t:t[n],i=o.heatmapMarkers,c=o.markers,l=Object(r.useState)(null),u=Object(d.a)(l,2),s=u[0],f=u[1],p=Object(r.useState)(null),h=Object(d.a)(p,2),m=h[0],g=h[1];return Object(r.useEffect)(function(){var e=Object.keys(c).filter(function(e){return"gene"!==e}),t=e.map(function(e){return{field:e,headerName:e.toUpperCase(),type:"CLUSTER"!==e.toUpperCase()?"number":"string",width:"CLUSTER"!==e.toUpperCase()?70:120}});t.unshift({field:"gene",headerName:"GENE",width:250});var n=t.map(function(e){return c[e.field]});n.forEach(function(e){return delete e.name});var r=n.reduce(function(e,t){return Object.values(t).map(function(t,n){return(e[n]||[]).concat(t)})},[]).map(function(t,n){var r={id:n,gene:t[0]};return e.forEach(function(e,n){r[e]=t[n+1]}),r});g(r),f({rows:r,columns:t})},[n]),a.a.createElement(a.a.Fragment,null,null!==s&&null!==i&&a.a.createElement(_.a,Object.assign({sx:{width:"100%"},slots:{toolbar:function(){return a.a.createElement(P.a,null,a.a.createElement(N.c,{printOptions:{disableToolbarButton:!0}}),a.a.createElement(I.a,{onClick:function(){f({columns:s.columns,rows:m})}},"All Markers"),a.a.createElement(I.a,{onClick:function(){if(i){var e=function(e){var t=Object.create(null);return e.reduce(function(e,n){return n.gene in t?n.diff>e[t[n.gene]].diff&&(e[t[n.gene]]=n):t[n.gene]=e.push(n)-1,e},[])}(s.rows.filter(function(e){return i.includes(e.gene)}));e.sort(function(e,t){return i.indexOf(e.gene.toLowerCase())-i.indexOf(t.gene.toLowerCase())}),f({columns:s.columns,rows:e})}}},"Heatmap Markers"))}}},s,{pagination:{paginationModel:{pageSize:25}}})))}var M=n(1986),D=n(1830),T=n(39),z=n.n(T),G=n(879),R=n.n(G),B=n(340);function F(e){return a.a.createElement(y.o,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)}function H(e){var t=e.inputRef,n=Object(D.a)(e,["inputRef"]);return a.a.createElement("div",Object.assign({ref:t},n))}function W(e){return a.a.createElement(y.n,Object.assign({fullWidth:!0,InputProps:{inputComponent:H,inputProps:Object(g.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))}function U(e){return a.a.createElement(y.f,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)}function V(e){return a.a.createElement(y.o,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)}function Y(e){return a.a.createElement(y.o,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)}function K(e){return a.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}function $(e){return a.a.createElement(y.a,{tabIndex:-1,label:e.children,className:z()(e.selectProps.classes.chip,Object(m.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:a.a.createElement(R.a,e.removeProps)})}function J(e){return a.a.createElement(y.h,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)}var q={Control:W,Menu:J,MultiValue:$,NoOptionsMessage:F,Option:U,Placeholder:V,SingleValue:Y,ValueContainer:K},Z={Control:W,Menu:J,MultiValue:$,NoOptionsMessage:F,Option:U,Placeholder:V,SingleValue:Y,ValueContainer:K,DropdownIndicator:function(){return null},IndicatorSeparator:function(){return null}};function Q(e){return a.a.createElement(y.g,null,a.a.createElement(B.b,Object.assign({},e,{textFieldProps:{InputLabelProps:{shrink:!1}},components:q})))}var X=a.a.forwardRef(function(e,t){var n=0;return a.a.createElement(y.g,null,a.a.createElement(B.a,Object.assign({ref:t},e,{filterOption:function(e,t){return e.label.toLowerCase().indexOf(t.toLowerCase())>=0&&n++<50},onInputChange:function(){n=0},textFieldProps:{InputLabelProps:{shrink:!1}},components:Z})))});function ee(){ee=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",h="suspendedYield",m="executing",d="completed",g={};function y(){}function v(){}function b(){}var x={};u(x,i,function(){return this});var E=Object.getPrototypeOf,w=E&&E(E(_([])));w&&w!==n&&r.call(w,i)&&(x=w);var O=b.prototype=y.prototype=Object.create(x);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=p;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return v.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function te(e){var t=e.classes,n=e.brushing,o=e.genesets,i=e.loadRemoteData,c=e.sNHControls,l=e.covs,u=e.discreteCovs,s=e.continuousCovs,f=e.features,p=Object(r.useState)([]),h=Object(d.a)(p,2),m=h[0],g=h[1],x=Object(r.useRef)(null),E=Object(r.useMemo)(function(){return u.map(function(e){return{label:e,options:Object(b.a)(new Set(l[e])).map(function(t){return{value:{group:e,term:t},label:t}})}})},[l,u]),w=Object(r.useMemo)(function(){var e=[{label:"discrete covs",options:u.map(function(e){return{value:e,label:e,group:"discrete covs"}})},{label:"continuous covs",options:s.map(function(e){return{value:e,label:e,group:"continuous covs"}})}];return f&&Object.entries(f).slice().reverse().forEach(function(t){var n=Object(d.a)(t,2),r=n[0],a=n[1];return e.push({label:r,options:a.map(function(e){return{value:e,label:e,group:r}})})}),e.push({label:"geneset",options:o.map(function(e){return{value:e,label:e,group:"geneset"}})}),e},[u,s,f,o]);function O(){return(O=Object(v.a)(ee().mark(function e(t){var r,a;return ee().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t?t.value:null)||r in l){e.next=5;break}return a="geneset"===t.group?"geneset":"feature",e.next=5,i(a,r);case 5:n.setColorBy(r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}return"none"===c?null:a.a.createElement("div",null,a.a.createElement(y.b,{className:t.searchControl,variant:"outlined"},a.a.createElement(Q,{classes:t,options:E,value:m,onChange:function(e){g(e),n.setFilter(e)},placeholder:"Select ",isMulti:!0})),a.a.createElement(y.b,{className:t.paintControl,variant:"outlined"},a.a.createElement(X,{classes:t,options:w,ref:x,formatCreateLabel:function(e){return"Look up feature: ".concat(e)},value:n.colorBy?{value:n.colorBy,label:n.colorBy}:null,onChange:function(e){return O.apply(this,arguments)},placeholder:"Paint ",isClearable:!0})))}function ne(){ne=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",h="suspendedYield",m="executing",d="completed",g={};function y(){}function v(){}function b(){}var x={};u(x,i,function(){return this});var E=Object.getPrototypeOf,w=E&&E(E(_([])));w&&w!==n&&r.call(w,i)&&(x=w);var O=b.prototype=y.prototype=Object.create(x);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=p;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return v.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}var re=function(e){var t=e.dataAPI,n=e.covs,a=Object(r.useState)(null),o=Object(d.a)(a,2),i=o[0],c=o[1];return[i,function(){var e=Object(v.a)(ne().mark(function e(r,a){var o,i,l,u,s;return ne().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=a.replace(/\u2013|\u2014|\u2212/g,"-"),e.next=3,fetch("".concat(t,"/").concat(r,"/").concat(a));case 3:return o=e.sent,e.next=6,o.json();case 6:if(i=e.sent,0!==Object.keys(i).length){e.next=10;break}return c(null),e.abrupt("return",null);case 10:return l="geneset"===r?"geneset":Object.keys(i)[0],u="geneset"===r?i:i[l],s={data:n.id.map(function(e){return e in u?u[e]:0}),category:l},c(s),e.abrupt("return",s);case 15:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()]},ae=n(84),oe=n(1990),ie=n(1992),ce=n(1993),le=n(1994),ue=n(1995),se=n(1996),fe=n(1991),pe=n(1997),he=n(1974);function me(e){var t=e.count,n=e.page,r=e.rowsPerPage,o=e.onPageChange,i="rtl"===Object(ae.a)().direction,c=function(e){return function(t){return o(t,e)}};return a.a.createElement(j.a,{sx:{flexShrink:0,ml:2.5}},a.a.createElement(oe.a,{onClick:c(0),disabled:0===n,"aria-label":"first page"},a.a.createElement(ie.a,null,i?"last_page":"first_page")),a.a.createElement(oe.a,{onClick:c(n-1),disabled:0===n,"aria-label":"previous page"},a.a.createElement(ie.a,null,i?"keyboard_arrow_right":"keyboard_arrow_left")),a.a.createElement(oe.a,{onClick:c(n+1),disabled:n>=Math.ceil(t/r)-1,"aria-label":"next page"},a.a.createElement(ie.a,null,i?"keyboard_arrow_left":"keyboard_arrow_right")),a.a.createElement(oe.a,{onClick:c(Math.max(0,Math.ceil(t/r)-1)),disabled:n>=Math.ceil(t/r)-1,"aria-label":"last page"},a.a.createElement(ie.a,null,i?"first_page":"last_page")))}function de(e){var t=e.features,n=(e.assay,Object(r.useState)(0)),o=Object(d.a)(n,2),i=o[0],c=o[1],l=Object(r.useState)(50),u=Object(d.a)(l,2),s=u[0],f=u[1];return a.a.createElement(ce.a,null,a.a.createElement(le.a,{sx:{maxWidth:600,marginTop:2,captionSide:"top"},size:"small","aria-label":"features table"},a.a.createElement(ue.a,null,Object(b.a)(Array(s).keys()).map(function(e){return a.a.createElement(se.a,{key:e},a.a.createElement(fe.a,{component:"th",scope:"row"},t[i*s*2+2*e]),Object(b.a)(Array(1).keys()).map(function(n){return a.a.createElement(fe.a,{align:"right",key:n},t[i*s*2+2*e+1+n]||"")}))})),a.a.createElement(pe.a,null,a.a.createElement(se.a,null,a.a.createElement(he.a,{rowsPerPageOptions:[5,15,50],colSpan:3,count:Math.ceil(t.length/2),rowsPerPage:s,page:i,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},onPageChange:function(e,t){return c(t)},onRowsPerPageChange:function(e){f(parseInt(e.target.value,10)),c(0)},ActionsComponent:me})))))}var ge=n(882),ye=n(529),ve=n(831);function be(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ee(e){var t=e.xys,n=e.colorBy,a=e.selected,o=e.covs,i=e.discreteCovs,c=e.continuousCovs,l=e.contrast,u=e.zTransform,s=e.remoteData;function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!isNaN(e))return e;if(e.startsWith("#")&&(e=function(e){var t;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),"rgba("+[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t].join(",")+",1)";throw new Error("Bad Hex")}(e)),e.startsWith("rgba")){var r=e.slice(5,-1).split(",").slice(0,-1).map(function(e){return Math.max(parseInt(e,10)-n,0)});return null!==t&&r.push(t),"rgba("+r.join()+")"}return null}var p,h=ve.plottingDefaults,m=h.maxRowsInTooltip,g=h.backgroundOpacity,y=h.backgroundSize,v=h.highlightOpacity,x=h.highlightSize,E=h.highlightBorderWidth,w=h.backgroundBorderWidth,O=(p=y)+(x-p)*l,j=function(e){return z(e.layout)},C=Object(r.useMemo)(function(){var e={colors:null,traceIdxes:null,isContinous:!1};if(null==n)return e;if(""!==n&&n in o&&i.includes(n)){var t=ge.d3.scale.category20(),r=Object(b.a)(new Set(o[n])).sort();r.forEach(function(e){return t(e)});var a={};r.forEach(function(e,t){return a[e]=t});var l,u={},f=be(r);try{for(f.s();!(l=f.n()).done;){var p=l.value;u[p]=t(p)}}catch(h){f.e(h)}finally{f.f()}return e.colors=o[n].map(function(e){return t(e)}),e.traces=r.map(function(e){return{idxes:[],name:e}}),o[n].forEach(function(t,n){return e.traces[a[t]].idxes.push(n)}),e}return""!==n&&n in o&&c.includes(n)?(e.colors=o[n],e.isContinous=!0,e):""===n||n in o||null===s?e:(e.colors=s.data,e.isContinous=!0,e)},[n,u,o,s]),L=C.colors,k=Object(r.useMemo)(function(){return null==L?null:L.map(function(e){return f(e,null,40)})},[n,o,s]),S=Object(r.useMemo)(function(){return null==L?null:L.map(function(e){return f(e,.8)})},[n,o,s]),P=Object(r.useMemo)(function(){if(null==o)return null;var e=Object.keys(o).slice(0,m);return 0===e.length?null:o[e[0]].map(function(t,r){if(null!=a&&!a[r])return null;var i="";return""!==n&&n in o?i+="".concat(n,": ").concat(o[n][r],"<br><br>"):""===n||null===n||n in o||null==s||(i+="".concat(n,": ").concat(s.data[r],"<br><br>")),i+=e.map(function(e){return"".concat(e,": ").concat(o[e][r])}).join("<br>")})},[o,n,a,s]),N=Object(r.useMemo)(function(){return null===a?.6:a.map(function(e){return e?v:g})},[a]),_=Object(r.useMemo)(function(){return null===a?6:a.map(function(e){return e?O:y})},[a]),I=Object(r.useMemo)(function(){return null===a?null:a.map(function(e){return e?v:g})},[a]),A=Object(r.useMemo)(function(){return null===a?null:a.map(function(e){return e?E:w})},[a]),M=Object(r.useState)({hovermode:"closest",showlegend:!0,margin:{l:0,r:0,t:0,b:0},legend:{x:1.2,xanchor:"right",y:.95},xaxis:{showline:!1,showgrid:!1,zeroline:!1,showticks:!1,showticklabels:!1},yaxis:{showline:!1,showgrid:!1,zeroline:!1,showticks:!1,showticklabels:!1},autosize:!0}),D=Object(d.a)(M,2),T=D[0],z=D[1],G=C.traces;return{data:null==G?[{x:t[0],y:t[1],type:"scattergl",mode:"markers",marker:{color:L,colorscale:u?"Picnic":null,colorbar:C.isContinous?{title:n,len:.9}:null,size:_,opacity:N,line:{width:A,opacity:I,color:k}},text:P,hoverlabel:{bgcolor:S},hoverinfo:"text",name:""}]:G.map(function(e){return{x:e.idxes.map(function(e){return t[0][e]}),y:e.idxes.map(function(e){return t[1][e]}),type:"scattergl",mode:"markers",marker:{color:e.idxes.map(function(e){return L[e]}),colorscale:u?"Picnic":null,colorbar:C.isContinous?{title:n,len:.9}:null,size:Object(ye.isArray)(_)?e.idxes.map(function(e){return _[e]}):_,opacity:Object(ye.isArray)(N)?e.idxes.map(function(e){return N[e]}):N,line:{width:null==A?null:e.idxes.map(function(e){return A[e]}),opacity:null==I?null:e.idxes.map(function(e){return I[e]}),color:null==k?null:e.idxes.map(function(e){return k[e]})}},text:e.idxes.map(function(e){return P[e]}),hoverlabel:{bgcolor:null==S?null:e.idxes.map(function(e){return S[e]})},hoverinfo:"text",name:e.name}}),frames:[],config:{displaylogo:!1,modeBarButtonsToRemove:["sendDataToCloud","hoverCompareCartesian","zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","toggleSpikelines"]},layout:T,useResizeHandler:!0,style:{},onInitialized:j,onUpdate:j}}function we(e,t,n){var a,o=t[e.layer],i=o.covs,c=o.discreteCovs,l=o.continuousCovs;switch(e.projection){case"umap":a="UMAP_1"in i?[i.UMAP_1,i.UMAP_2]:[i.umap_1,i.umap_2];break;case"tsne":a="tSNE_1"in i?[i.tSNE_1,i.tSNE_2]:[i.tsne_1,i.tsne_2];break;default:a=[null,null]}var u=function(e){var t=e.covs,n=Object(r.useState)(""),a=Object(d.a)(n,2),o=a[0],i=a[1],c=Object(r.useState)([]),l=Object(d.a)(c,2),u=l[0],s=l[1],f=Object(r.useState)(1),p=Object(d.a)(f,2),h=p[0],m=p[1],g=Object(r.useState)(!1),y=Object(d.a)(g,2),v=y[0],b=y[1];return{selected:Object(r.useMemo)(function(){return null!==u&&u.length>0&&null!==t&&u[0].value.group in t?t[u[0].value.group].map(function(e,n){return u.some(function(e){var r=e.value,a=r.group,o=r.term;return t[a][n]===o})}):null},[u,t]),setColorBy:i,colorBy:o,filter:u,setFilter:s,selectSubpop:function(e){s(e)},contrast:h,setContrast:m,zTransform:v,setZTransform:b}}(t[e.layer]);return[Ee({xys:a,colorBy:u.colorBy,selected:u.selected,covs:i,discreteCovs:c,continuousCovs:l,contrast:u.contrast,zTransform:u.zTransform,remoteData:n}),u]}function Oe(){Oe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new N(r||[]);return a(i,"_invoke",{value:L(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",h="suspendedYield",m="executing",d="completed",g={};function y(){}function v(){}function b(){}var x={};u(x,i,function(){return this});var E=Object.getPrototypeOf,w=E&&E(E(_([])));w&&w!==n&&r.call(w,i)&&(x=w);var O=b.prototype=y.prototype=Object.create(x);function j(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function C(e,t){function n(a,o,i,c){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==typeof s&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,c)},function(e){n("throw",e,i,c)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,c)})}c(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t(function(t,a){n(e,r,t,a)})}return o=o?o.then(a,a):a()}})}function L(t,n,r){var a=p;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=k(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var u=f(t,n,r);if("normal"===u.type){if(a=r.done?d:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function k(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return v.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(C.prototype),u(C.prototype,c,function(){return this}),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new C(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},j(O),u(O,l,"Generator"),u(O,i,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function je(e){var t=e.classes,n=e.settings,o=e.panelDataState,i=e.panelIdx,c=(e.openChooseDataset,e.loadDataPanel),l=e.maximized,u=e.toggleMaximize,s=Object(r.useMemo)(function(){return n.datasets.map(function(e,t){return{value:t,label:e.name}})},[n]),f=(o.status,o.error,o.data),p=f.data,h=f.dataAPI,m=f.genesets,b=f.name,x=Object(r.useState)(!1),E=Object(d.a)(x,2),C=E[0],k=E[1],P={};function N(e){var t=null;if(null!=e&&e.length>0){var n=e.filter(function(e){return e.toLowerCase().includes("default")}),r=e.filter(function(e){return e.toLowerCase().includes("curated")}),a=e.filter(function(e){return e.toLowerCase().includes("prelim")}),o=e.filter(function(e){return e.toLowerCase().includes("main")});n.length>0?t=n[0]:r.length>0?t=r[0]:a.length>0?t=a[0]:o.length>0?t=o[0]:e.length>0&&(t=e[0])}return{value:t,label:t}}p.layers.forEach(function(e){var t=p.layersData[e.id].covs,n=[];("UMAP_1"in t||"umap_1"in t)&&n.push("umap"),("TSNE_1"in t||"tsne_1"in t||"tSNE_1"in t)&&n.push("tsne"),P[e.id]=n});var _={projection:P[p.layers[0].id][0],feature:null,layer:p.layers[0].id,mode:["plot"],modeAssay:p.meta.assays[0],heatmapMode:"heatmap",clustering:N(p.layersData[p.layers[0].id].clusterings),selectedHeatmapAssay:null},I=Object(r.useState)(_),D=Object(d.a)(I,2),T=D[0],z=D[1],G=p.layersData[T.layer].clusterings,R=[{name:"plot",icon:"scatter_plot"}];null!=G&&Object.keys(G).length>0&&R.push({name:"heatmap",icon:"grid_view"}),R.push({name:"legends",icon:"table"});var B=re({dataAPI:h,dataConfig:T,covs:p.layersData[T.layer].covs}),F=Object(d.a)(B,2),H=F[0],W=F[1],U=we(T,p.layersData,H),V=Object(d.a)(U,2),Y=V[0],K=V[1],$=function(){var e=["none","with-select-paint"],t=Object(r.useState)(0),n=Object(d.a)(t,2),a=n[0],o=n[1];return[e[a],function(){o((a+1)%e.length)}]}(),J=Object(d.a)($,2),q=J[0],Z=J[1],X=P[T.layer];function ee(e,t){k(!1),e.value!==o.data.datasetIdx&&c(e.value,i)}function ne(e){if(null!=e&&e.value!=T.clustering.value){var t=Object(g.a)({},T);t.clustering=e,ce(null),z(t)}}Y.layout.showlegend=l,Y.layout.margin.r=0;var ae=Object(r.useState)(null),oe=Object(d.a)(ae,2),ie=oe[0],ce=oe[1],le=Object(r.useState)(!0),ue=Object(d.a)(le,2),se=ue[0],fe=ue[1],pe=Object(r.useState)(!0),he=Object(d.a)(pe,2),me=he[0];he[1];Object(r.useEffect)(function(){if(null!=T.clustering&&null!==T.clustering.value){var e="".concat(p.url,"/").concat(T.layer,"/clustering/").concat(T.clustering.value).concat(me?"/true":"");fe(!0),function(){var t=Object(v.a)(Oe().mark(function t(){var n;return Oe().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return t.next=4,t.sent.json();case 4:n=t.sent,ce(n),fe(!1);case 7:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()}},[T.clustering]);var ge=T.selectedHeatmapAssay;if(ie){var ye=Object.keys(ie);ye.includes("markers")?ge=null:null!=ge&&ye.includes(ge)||(ge=ye.pop())}function ve(e){null!=e&&function(e){var t=Object(g.a)({},T,{selectedHeatmapAssay:e});z(t)}(e)}function be(){return R.filter(function(e){return T.mode.includes(e.name)}).map(function(e){return e.name})}function xe(){return C?a.a.createElement(y.b,{className:t.chooseDatasetControl,variant:"outlined"},a.a.createElement(Q,{classes:t,options:s,value:{value:o.data.datasetIdx,label:o.data.name},onChange:ee,defaultMenuIsOpen:!0,onMenuClose:function(){k(!1)},placeholder:"Select "})):a.a.createElement(a.a.Fragment,null,a.a.createElement(y.e,{color:"primary",onClick:function(){return k(!0)}},a.a.createElement(y.d,null,"folder")),a.a.createElement("span",null,a.a.createElement("i",null,b)))}function Ee(){var e=T.heatmapMode,n=T.clustering,r=T.layer,o=be().includes("heatmap");if(!o)return null;var i={margin:"0px",top:0,marginLeft:be().includes("plot")|!l?"0px":"300px"},c=!se&&o,u=!se&&"none"!==q&&ie&&!Object.keys(ie).includes("markers");return a.a.createElement(y.c,{item:!0,xs:Le,className:t.plot,style:{overflowY:"scroll"}},"none"!==q&&a.a.createElement("div",{className:l?t.floatingControls:t.fixedControls,style:{top:0}},a.a.createElement(y.b,{className:t.parintControl,style:i,variant:"outlined"},a.a.createElement(Q,{classes:t,options:G.map(function(e){return{value:e,label:e}}),value:n,onChange:ne,placeholder:"Select"})),c&&a.a.createElement(w.a,{style:{margin:"0px",top:0,marginLeft:"100px"},color:"primary",value:e,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(g.a)({},T);t.heatmapMode=e,z(t)}}(t)}},a.a.createElement(O.a,{key:"toggleHeatmapMode-plot",value:"heatmap"},"HEATMAP"),a.a.createElement(O.a,{key:"toggleHeatmapMode-markers-table",value:"markers-table"},"MARKERS")),u&&a.a.createElement(w.a,{style:{margin:"0px",top:0,marginLeft:"20px"},color:"primary",value:ge,exclusive:!0,onChange:function(e,t){return ve(t)}},Object.keys(ie).map(function(e,t){return a.a.createElement(O.a,{key:"toggleSelectedHeatmapAssay-".concat(t),value:e},e)}))),a.a.createElement("div",{style:{marginTop:50,width:"100%"}},se&&a.a.createElement(j.a,{sx:{display:"flex",justifyContent:"center"}},a.a.createElement(M.a,null)),!se&&ie&&"markers-table"===e&&a.a.createElement(A,{clusteringData:ie,selectedHeatmapAssay:ge}),!se&&ie&&"heatmap"===e&&a.a.createElement(S,{data:ie,usingFullMatrix:me,clustering:n.value,layer:r,heatmapAssayInEffect:ge,sNHControls:q})))}var je=T.mode.includes("plot"),Ce=T.mode.includes("legends"),Le=12/be().length,ke=je||T.mode.includes("heatmap"),Se={margin:"5px"};function Pe(){if("none"===q)return null;return a.a.createElement(y.c,{container:!0,className:t.toggleProjection},a.a.createElement(w.a,{style:Se,color:"primary",value:T.mode,exclusive:!l,onChange:function(e,t){return function(e){if(null!=e){var t=Object(g.a)({},T);t.mode=e,z(t)}}(t)}},R.map(function(e){return a.a.createElement(O.a,{"data-test-id":"mode-type",key:"mode_".concat(e.name),value:e.name},a.a.createElement(y.d,null,e.icon))})),null,je&&a.a.createElement(w.a,{style:Se,color:"primary",value:T.projection,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(g.a)({},T);t.projection=e,z(t)}}(t)}},X.map(function(e){return a.a.createElement(O.a,{"data-test-id":"projection-type",key:"toggleProjection".concat(e),value:e},e)})),ke&&a.a.createElement(w.a,{style:Se,color:"primary",value:T.layer,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(g.a)({},T);t.layer=e,t.clustering=N(p.layersData[e].clusterings),ce(null),z(t)}}(t)}},p.layers.map(function(e){return a.a.createElement(O.a,{"data-test-id":"layer-type",key:"layer_".concat(e.id),value:e.id},e.name)})))}return a.a.createElement(y.h,{className:t.paper},a.a.createElement(y.c,{container:!0,className:t.headerPanel,alignItems:"center"},a.a.createElement(xe,null)),je&&a.a.createElement("div",{className:t.floatingControls},a.a.createElement(te,{classes:t,covs:p.layersData[T.layer].covs,features:p.meta.features,continuousCovs:p.layersData[T.layer].continuousCovs,discreteCovs:p.layersData[T.layer].discreteCovs,brushing:K,genesets:m,remoteData:H,loadRemoteData:W,sNHControls:q})),a.a.createElement(y.c,{container:!0,className:t.plotMain,spacing:0},je&&a.a.createElement(y.c,{item:!0,xs:Le,className:t.plot},a.a.createElement(L.a,{className:t.plot,data:Y.data,layout:Y.layout,config:Y.config,useResizeHandler:Y.useResizeHandler})),a.a.createElement(Pe,null),a.a.createElement(Ee,null),Ce&&a.a.createElement(y.c,{item:!0,xs:Le,className:t.plot,style:{overflowY:"scroll"}},"none"!==q&&a.a.createElement("div",{className:l?t.floatingControls:t.fixedControls,style:{top:0}},a.a.createElement(w.a,{style:{margin:"0px",top:0,marginLeft:"100px"},color:"primary",value:T.modeAssay,exclusive:!0,onChange:function(e,t){return function(e){if(null!=e){var t=Object(g.a)({},T);t.modeAssay=e,z(t)}}(t)}},p.meta.assays.concat("genesets").map(function(e){return a.a.createElement(O.a,{"data-test-id":"assay-type",key:"toggleModeAssay".concat(e),value:e},e)}))),a.a.createElement(de,{style:{overflow:"scroll"},features:"genesets"===T.modeAssay?m:p.meta.features[T.modeAssay],assay:T.modeAssay}))),a.a.createElement(y.c,{container:!0,className:t.footerPanel,alignItems:"center"},a.a.createElement("div",{style:{margin:"auto"}},a.a.createElement(y.e,{onClick:u,color:"primary"},a.a.createElement(y.d,null,"view_column")),a.a.createElement(y.e,{onClick:Z,color:"primary"},a.a.createElement(y.d,null,function(){switch(q){case"none":case"with-select-paint":return"fullscreen_exit";case"with-select-paint-geneset":return"fullscreen";default:return null}}())),p.zip&&a.a.createElement(y.e,{style:{marginLeft:"20px"},onClick:function(){window.open("report/".concat(p.zip))},color:"primary"},a.a.createElement(y.d,null,"download")))))}var Ce=Object(c.withStyles)(function(e){return{root:{flexGrow:1,height:"100%",width:"100%"},input:{display:"flex",padding:0},title:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,marginTop:0,marginBottom:0,wordWrap:"break-word"},card:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},paper:{height:"100%",width:"100%"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},floatingControls:{position:"absolute",zIndex:10},fixedControls:{zIndex:10},controlArea:{},center:{position:"absolute",top:"50%",left:"30%",right:"30%",backgroundColor:"white",marginLeft:"auto",marginRight:"auto",padding:"20px",zIndex:100},plotMain:{height:"calc(100vh - 6em)",width:"100%"},plot:{height:"100%",width:"calc(100% - 5px)"},toggleProjection:{position:"absolute",width:"30%",bottom:"40px",zIndex:200},footer:{position:"absolute",width:"100%",marginBottom:"0px",padding:"0px",bottom:"0px",fontSize:"0.8em",zIndex:10},headerPanel:{whiteSpace:"nowrap",margin:"0px",minHeight:"48px",padding:"0px",align:"left",top:"0px",fontSize:"0.8em",zIndex:10},footerPanel:{whiteSpace:"nowrap",marginBottom:"0px",padding:"0px",align:"center",bottom:"0px",fontSize:"0.8em",zIndex:10},chooseDatasetControl:{position:"absolute",top:1,marginLeft:1,zIndex:300},searchControl:{margin:e.spacing.unit,minWidth:100,maxWidth:300},paintControl:{margin:e.spacing.unit,minWidth:100,maxWidth:300},paintGenesetControl:{margin:e.spacing.unit,minWidth:100,maxWidth:300}}})(function(e){var t=e.classes,n=e.settings,o=e.initialDatasetIdx,i=E({datasets:n.datasets,initialDatasetIdx:o,nPanels:3}),c=Object(d.a)(i,2),l=c[0],u=c[1],s=Object(r.useState)(0),f=Object(d.a)(s,2),p=f[0],h=f[1];function m(e){null!=e&&h(e)}return a.a.createElement(y.c,{container:!0,className:t.root,spacing:0},-1===p?Array(3).fill(0).map(function(e,r){return a.a.createElement(y.c,{key:"scpanel_".concat(r),item:!0,xs:4},null===l[r].data?"Loading":a.a.createElement(je,{classes:t,settings:n,panelDataState:l[r],panelIdx:r,loadDataPanel:u,maximized:!1,toggleMaximize:function(){return m(r)}}))}):a.a.createElement(y.c,{item:!0,xs:12},null===l[p].data?"Loading":a.a.createElement(je,{settings:n,classes:t,panelDataState:l[p],panelIdx:p,loadDataPanel:u,maximized:!0,toggleMaximize:function(){return m(-1)}})))}),Le=n(333),ke=n.n(Le),Se=n(336),Pe=n.n(Se),Ne=n(334),_e=n.n(Ne),Ie=n(144),Ae=n.n(Ie),Me=n(335),De=n.n(Me),Te=n(832),ze=n.n(Te);function Ge(e){return a.a.createElement(ze.a,null,a.a.createElement(Ae.a,e))}var Re=Object(c.withStyles)(function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper},subtitle:{marginLeft:"10px",backgroundColor:e.palette.background.accent},tableRow:{"&:hover":{backgroundColor:e.palette.background.paper},cursor:"pointer"},buildInfo:{float:"right",fontStyle:"italic",fontSize:"x-small"},stickyHeader:{position:"sticky",top:0,backgroundColor:e.palette.background.paper,zIndex:1}}})(function(e){var t=e.classes,n=e.open,o=e.onClose,i=e.pristine,c=e.title,l=e.datasets,u=e.versions,s=e.onGroupClick,f=Object(r.useState)("grab"),p=Object(d.a)(f,2),h=p[0],m=p[1],v=l.map(function(e){return Object(g.a)({},e,{organ:e.organ||""})}).sort(function(e,t){return"multiome"===e.name?-1:"multiome"===t.name?1:e.organ?t.organ?e.organ<t.organ?-1:e.organ>t.organ?1:0:-1:1});return a.a.createElement("div",null,a.a.createElement(ke.a,{open:n,onClose:function(){m("grab"),o(null)},PaperComponent:Ge,className:t.root,disableBackdropClick:i,disableEscapeKeyDown:i,"aria-labelledby":"draggable-dialog-title",maxWidth:"md"},a.a.createElement(_e.a,{id:"draggable-dialog-title"},c),a.a.createElement(De.a,null,a.a.createElement("h5",{className:t.subtitle}," ",a.a.createElement("small",null,"Select data")," "),a.a.createElement(y.i,null,a.a.createElement(y.l,null,a.a.createElement(y.m,{className:t.stickyHeader},a.a.createElement(y.k,null,"dataset"),a.a.createElement(y.k,null,"organ"),a.a.createElement(y.k,null,"layers"),a.a.createElement(y.k,null,"modalities"),a.a.createElement(y.k,null,"reference"))),a.a.createElement(y.j,null,v.map(function(e,n){var i=e.displayName,c=e.organ,l=e.name,u=e.layers,f=e.modalities,p=e.reference,d=e.isGroup,g=e.datasets,v=e.expanded;return a.a.createElement(r.Fragment,{key:n},a.a.createElement(y.m,{className:t.tableRow,style:{cursor:h},hover:!0,onClick:function(){d?s(l):(m("wait"),o(n))}},a.a.createElement(y.k,null,d?"".concat(v?"-":"+"," ").concat(i):l),a.a.createElement(y.k,null,d?c:"")," ",a.a.createElement(y.k,null,d?"":u.length),a.a.createElement(y.k,null,d?"":f.length),a.a.createElement(y.k,null,d&&!p?"":null!==p?a.a.createElement("a",{href:p,target:"_blank",rel:"noreferrer noopener"},p):"")),d&&v&&g.map(function(e,r){return a.a.createElement(y.m,{key:"".concat(n,"-").concat(r),className:t.tableRow,style:{cursor:h},hover:!0,onClick:function(){m("wait"),o(e.originalIndex)}},a.a.createElement(y.k,{style:{paddingLeft:"30px"}},e.name),a.a.createElement(y.k,null,"")," ",a.a.createElement(y.k,null,e.layers.length),a.a.createElement(y.k,null,e.modalities.length),a.a.createElement(y.k,null,null!==e.reference?a.a.createElement("a",{href:e.reference,target:"_blank",rel:"noreferrer noopener"},e.reference):""))}))}))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(Pe.a,null),a.a.createElement("br",null),a.a.createElement("span",{className:t.buildInfo},"ISCVA v",u.version,", \xa0\xa0 revision"," ",u.revision,"\xa0\xa0\xa0\xa0\xa0",a.a.createElement("a",{href:"https://chenlab.chpc.utah.edu/about-iscva/"},a.a.createElement("i",null,"About"))))))}),Be={version:"0.1.0",revision:"06244cd",branch:"main"},Fe=Object.entries({Bladder:["BLCA"],Blood:["AEL","AML","ALL","CLL","PBMC"],Bone:["MM","GCTB","OS"],Brain:["Glioma","MB"],Breast:["BRCA"],Colorectum:["CRC"],Esophagus:["ESCA"],Eye:["RB","UVM"],"Head & Neck":["HNSC"],Kidney:["KIRC","KICH","KIPAN"],Liver:["CHOL","LIHC","HB"],Lung:["NSCLC","SCLC"],"Lymph node":["NHL","DLBC"],"Nervous system":["MPNST","NET","NB","Neurofibroma"],Pancreas:["PAAD"],"Pelvic cavity":["CESC","OV","UCEC"],Prostate:["PRAD"],Skin:["BCC","MCC","MF","PCFCL","SCC","SKCM"],"Soft tissue":["GIST","SARC","PPB","SS"],Stomach:["STAD"]}).reduce(function(e,t){var n=Object(d.a)(t,2),r=n[0];return n[1].forEach(function(t){e[t]=r}),e},{}),He=Object(c.withStyles)(function(e){return{fab:{margin:e.spacing.unit,position:"absolute",right:"10px",bottom:"10px",zIndex:100},fab2:{margin:e.spacing.unit,position:"absolute",right:"100px",bottom:"10px",zIndex:200}}})(function(e){e.classes;var t=Object(r.useState)({settings:null,dragged:!1,openChooseData:!0,pristineChooseData:!0,initialDatasetIdx:null,groupedDatasets:{},expandedGroups:{}}),n=Object(d.a)(t,2),o=n[0],i=n[1];Object(r.useEffect)(function(){fetch("/iscvam/app-settings.json").then(function(e){return e.json()}).then(function(e){var t=function(e){var t={};return e.forEach(function(e,n){var r=(e.name||"").split("_")[0];t[r]||(t[r]=[]),t[r].push(Object(g.a)({},e,{originalIndex:n}))}),t}(e.datasets);i(function(n){return Object(g.a)({},n,{settings:e,groupedDatasets:t})})})},[]);return a.a.createElement("div",{className:"App"},null!==o.settings&&a.a.createElement(Re,{onClose:function(e){i(function(t){return Object(g.a)({},t,{openChooseData:!1,initialDatasetIdx:e,pristineChooseData:null===e})})},datasets:Object.keys(o.groupedDatasets).map(function(e){return{displayName:"".concat(e," (").concat(o.groupedDatasets[e].length,")"),organ:Fe[e],name:e,layers:[],modalities:[],reference:null,isGroup:!0,datasets:o.groupedDatasets[e],expanded:o.expandedGroups[e]||!1}}),open:o.openChooseData,pristine:o.pristineChooseData,title:"ISCVA",versions:Be,onGroupClick:function(e){i(function(t){return Object(g.a)({},t,{expandedGroups:Object(g.a)({},t.expandedGroups,Object(m.a)({},e,!t.expandedGroups[e]))})})}}),null!==o.initialDatasetIdx&&a.a.createElement(Ce,{settings:o.settings,initialDatasetIdx:o.initialDatasetIdx}))}),We=Object(c.createMuiTheme)({palette:{primary:u.a,secondary:f.a,error:h.a,contrastThreshold:3,tonalOffset:.2},typography:{useNextVariants:!0}}),Ue=function(){return a.a.createElement(c.MuiThemeProvider,{theme:We},a.a.createElement(He,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(1888);i.a.render(a.a.createElement(Ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},831:function(e){e.exports={tsneComputationDefaults:{perplexity:16,npcs:60,maxPerplexity:39,minPerplexity:1},plottingDefaults:{maxRowsInTooltip:10,highlightOpacity:.5,highlightSize:8,backgroundOpacity:.3,backgroundSize:2,highlightBorderWidth:1,backgroundBorderWidth:0}}},846:function(e,t,n){e.exports=n(1826)},851:function(e,t,n){},853:function(e,t,n){}},[[846,2,1]]]);
//# sourceMappingURL=main.96365d3a.chunk.js.map